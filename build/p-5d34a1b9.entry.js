import{r as t,h as e,H as n,g as r,f as i}from"./p-2dcdb1f0.js";const o=":host{display:block}";const s=class{constructor(e){t(this,e)}render(){return e(n,null,e("slot",null),e("arcgis-stat-card",{"value-color":"","card-title":"Pageviews","title-tooltip":"Every visit to this item's page.",subtitle:"Last 30 Days",value:"1,042","text-align":"end","trailing-text":"",unit:"","unit-position":"after",corners:"squared",shareable:"true","shareable-by-value":"false","shareable-on-hover":"true"},e("calcite-icon",{icon:"arrow-bold-up",slot:"value-media"}),e("div",{slot:"footer"},e("svg",{width:"100%",viewBox:"0 0 440 120",class:"chart"},e("polyline",{fill:"none",stroke:"#0074d9","stroke-width":"2",points:"00,120 20,60 40,80 60,20 80,80 100,80 120,60 140,100 160,90 180,80 200, 110 220, 10 240, 70 260, 100 280, 100 300, 40 320, 0 340, 100 360, 100 380, 120 400, 60 420, 70 440, 80"})))))}};s.style=o;const a=":host{display:block}";const c=class{constructor(e){t(this,e)}render(){return e(n,null,e("slot",null),e("ul",null,e("li",null,"Item 1"),e("li",null,"Item 2"),e("li",null,"Item 3"),e("li",null,"Item 4")))}};c.style=a;const u=(t,e,n)=>{const r=t.get(e);if(!r){t.set(e,[n])}else if(!r.includes(n)){r.push(n)}};const l=(t,e)=>{let n;return(...r)=>{if(n){clearTimeout(n)}n=setTimeout((()=>{n=0;t(...r)}),e)}};const d=t=>!("isConnected"in t)||t.isConnected;const f=l((t=>{for(let e of t.keys()){t.set(e,t.get(e).filter(d))}}),2e3);const p=()=>{if(typeof r!=="function"){return{}}const t=new Map;return{dispose:()=>t.clear(),get:e=>{const n=r();if(n){u(t,e,n)}},set:e=>{const n=t.get(e);if(n){t.set(e,n.filter(i))}f(t)},reset:()=>{t.forEach((t=>t.forEach(i)));f(t)}}};const h=t=>typeof t==="function"?t():t;const m=(t,e=((t,e)=>t!==e))=>{const n=h(t);let r=new Map(Object.entries(n!==null&&n!==void 0?n:{}));const i={dispose:[],get:[],set:[],reset:[]};const o=()=>{var e;r=new Map(Object.entries((e=h(t))!==null&&e!==void 0?e:{}));i.reset.forEach((t=>t()))};const s=()=>{i.dispose.forEach((t=>t()));o()};const a=t=>{i.get.forEach((e=>e(t)));return r.get(t)};const c=(t,n)=>{const o=r.get(t);if(e(n,o,t)){r.set(t,n);i.set.forEach((e=>e(t,n,o)))}};const u=typeof Proxy==="undefined"?{}:new Proxy(n,{get(t,e){return a(e)},ownKeys(t){return Array.from(r.keys())},getOwnPropertyDescriptor(){return{enumerable:true,configurable:true}},has(t,e){return r.has(e)},set(t,e,n){c(e,n);return true}});const l=(t,e)=>{i[t].push(e);return()=>{g(i[t],e)}};const d=(e,n)=>{const r=l("set",((t,r)=>{if(t===e){n(r)}}));const i=l("reset",(()=>n(h(t)[e])));return()=>{r();i()}};const f=(...t)=>{const e=t.reduce(((t,e)=>{if(e.set){t.push(l("set",e.set))}if(e.get){t.push(l("get",e.get))}if(e.reset){t.push(l("reset",e.reset))}if(e.dispose){t.push(l("dispose",e.dispose))}return t}),[]);return()=>e.forEach((t=>t()))};const p=t=>{const e=r.get(t);i.set.forEach((n=>n(t,e,e)))};return{state:u,get:a,set:c,on:l,onChange:d,use:f,dispose:s,reset:o,forceUpdate:p}};const g=(t,e)=>{const n=t.indexOf(e);if(n>=0){t[n]=t[t.length-1];t.length--}};const b=(t,e)=>{const n=m(t,e);n.use(p());return n};const{state:v,onChange:w}=b({user:null,context:null,app:{client:"2kAcJaj7GkBYg2Wp",redirect:"http://localui.arcgis.com:3333/redirect.html",portal:"https://dc.mapsqa.arcgis.com"}});w("user",(t=>{console.debug("Updated user",{user:t,context:t.context,hubRequestOptions:t.hubRequestOptions});v.user=t}));w("context",(t=>{console.debug("Updated context",{context:t});v.context=t;v.user=t===null||t===void 0?void 0:t._currentUser}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var y=function(t,e){y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n]};return y(t,e)};function k(t,e){y(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var O=function(){O=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o))e[o]=n[o]}return e};return O.apply(this,arguments)};function S(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function D(t){return Object.keys(t).some((function(e){var n=t[e];if(!n){return false}if(n&&n.toParam){n=n.toParam()}var r=n.constructor.name;switch(r){case"Array":return false;case"Object":return false;case"Date":return false;case"Function":return false;case"Boolean":return false;case"String":return false;case"Number":return false;default:return true}}))}function E(t){var e={};Object.keys(t).forEach((function(n){var r,i;var o=t[n];if(o&&o.toParam){o=o.toParam()}if(!o&&o!==0&&typeof o!=="boolean"&&typeof o!=="string"){return}var s=o.constructor.name;var a;switch(s){case"Array":var c=(i=(r=o[0])===null||r===void 0?void 0:r.constructor)===null||i===void 0?void 0:i.name;a=c==="Array"?o:c==="Object"?JSON.stringify(o):o.join(",");break;case"Object":a=JSON.stringify(o);break;case"Date":a=o.valueOf();break;case"Function":a=null;break;case"Boolean":a=o+"";break;default:a=o;break}if(a||a===0||typeof a==="string"||Array.isArray(a)){e[n]=a}}));return e}function x(t,e){if(Array.isArray(e)&&e[0]&&Array.isArray(e[0])){return e.map((function(e){return x(t,e)})).join("&")}return encodeURIComponent(t)+"="+encodeURIComponent(e)}function A(t){var e=E(t);return Object.keys(e).map((function(t){return x(t,e[t])})).join("&")}function $(t,e){var n=D(t)||e;var r=E(t);if(n){var i=new FormData;Object.keys(r).forEach((function(t){if(typeof Blob!=="undefined"&&r[t]instanceof Blob){var e=r["fileName"]||r[t].name||t;i.append(t,r[t],e)}else if(r[t].constructor&&r[t].constructor.name==="ReadStream"&&Number.isInteger(r["dataSize"])){i.append(t,r[t],{knownLength:r["dataSize"]})}else{i.append(t,r[t])}}));return i}else{return A(t)}}var j=function(){function t(t,e,n,r,i){t=t||"UNKNOWN_ERROR";e=e||"UNKNOWN_ERROR_CODE";this.name="ArcGISRequestError";this.message=e==="UNKNOWN_ERROR_CODE"?t:e+": "+t;this.originalMessage=t;this.code=e;this.response=n;this.url=r;this.options=i}return t}();j.prototype=Object.create(Error.prototype);j.prototype.constructor=j;function T(t){if(console&&console.warn){console.warn.apply(console,[t])}}var P="@esri/arcgis-rest-js";var N={httpMethod:"POST",params:{f:"json"}};var R=function(t){k(e,t);function e(e,n,r,i,o){if(e===void 0){e="AUTHENTICATION_ERROR"}if(n===void 0){n="AUTHENTICATION_ERROR_CODE"}var s=t.call(this,e,n,r,i,o)||this;s.name="ArcGISAuthError";s.message=n==="AUTHENTICATION_ERROR_CODE"?e:n+": "+e;return s}e.prototype.retry=function(t,e){var n=this;if(e===void 0){e=3}var r=0;var i=function(o,s){t(n.url,n.options).then((function(t){var e=O(O({},n.options),{authentication:t});r=r+1;return _(n.url,e)})).then((function(t){o(t)})).catch((function(t){if(t.name==="ArcGISAuthError"&&r<e){i(o,s)}else if(t.name==="ArcGISAuthError"&&r>=e){s(n)}else{s(t)}}))};return new Promise((function(t,e){i(t,e)}))};return e}(j);function I(t,e,n,r,i){if(t.code>=400){var o=t.message,s=t.code;throw new j(o,s,t,e,r)}if(t.error){var a=t.error,o=a.message,s=a.code,c=a.messageCode;var u=c||s||"UNKNOWN_ERROR_CODE";if(s===498||s===499||c==="GWM_0003"||s===400&&o==="Unable to generate token."){if(i){throw i}else{throw new R(o,u,t,e,r)}}throw new j(o,u,t,e,r)}if(t.status==="failed"||t.status==="failure"){var o=void 0;var s="UNKNOWN_ERROR_CODE";try{o=JSON.parse(t.statusMessage).message;s=JSON.parse(t.statusMessage).code}catch(e){o=t.statusMessage||t.message}throw new j(o,s,t,e,r)}return t}function _(t,e){if(e===void 0){e={params:{f:"json"}}}var n=O(O(O({httpMethod:"POST"},N),e),{params:O(O({},N.params),e.params),headers:O(O({},N.headers),e.headers)});var r=[];var i=[];if(!n.fetch&&typeof fetch!=="undefined"){n.fetch=fetch.bind(Function("return this")())}else{r.push("`fetch`");i.push("`node-fetch`")}if(typeof Promise==="undefined"){r.push("`Promise`");i.push("`es6-promise`")}if(typeof FormData==="undefined"){r.push("`FormData`");i.push("`isomorphic-form-data`")}if(!n.fetch||typeof Promise==="undefined"||typeof FormData==="undefined"){throw new Error("`arcgis-rest-request` requires a `fetch` implementation and global variables for `Promise` and `FormData` to be present in the global scope. You are missing "+r.join(", ")+". We recommend installing the "+i.join(", ")+" modules at the root of your application to add these to the global scope. See https://bit.ly/2KNwWaJ for more info.")}var o=n.httpMethod,s=n.authentication,a=n.rawResponse;var c=O({f:"json"},n.params);var u=null;var l={method:o,credentials:n.credentials||"same-origin"};if(n.headers&&n.headers["X-Esri-Auth-Client-Id"]&&t.indexOf("/oauth2/platformSelf")>-1){l.credentials="include"}return(s?s.getToken(t,{fetch:n.fetch}).catch((function(e){e.url=t;e.options=n;u=e;return Promise.resolve("")})):Promise.resolve("")).then((function(e){if(e.length){c.token=e}if(s&&s.getDomainCredentials){l.credentials=s.getDomainCredentials(t)}var r={};if(l.method==="GET"){if(c.token&&n.hideToken&&typeof window==="undefined"){r["X-Esri-Authorization"]="Bearer "+c.token;delete c.token}var i=A(c);var o=i===""?t:t+"?"+A(c);if(n.maxUrlLength&&o.length>n.maxUrlLength||c.token&&n.hideToken){l.method="POST";if(e.length&&n.hideToken){c.token=e;delete r["X-Esri-Authorization"]}}else{t=o}}var a=new RegExp("/items/.+/updateResources").test(t);if(l.method==="POST"){l.body=$(c,a)}l.headers=O(O({},r),n.headers);if(typeof window==="undefined"&&!l.headers.referer){l.headers.referer=P}if(!D(c)&&!a){l.headers["Content-Type"]="application/x-www-form-urlencoded"}return n.fetch(t,l)})).then((function(e){if(!e.ok){var r=e.status,i=e.statusText;throw new j(i,"HTTP "+r,e,t,n)}if(a){return e}switch(c.f){case"json":return e.json();case"geojson":return e.json();case"html":return e.text();case"text":return e.text();default:return e.blob()}})).then((function(e){if((c.f==="json"||c.f==="geojson")&&!a){var r=I(e,t,c,n,u);if(u){var i=t.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];n.authentication.federatedServers[i]={token:[],expires:new Date(Date.now()+86400*1e3)};u=null}return r}else{return e}}))}function q(t,e,n){var r=["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"];var i=O(O({params:{}},n),t);i.params=e.reduce((function(e,n){if(t[n]||typeof t[n]==="boolean"){e[n]=t[n]}return e}),i.params);return r.reduce((function(t,e){if(i[e]){t[e]=i[e]}return t}),{})}function C(t){if(typeof t!=="string"){return t}t=t.trim();if(t[t.length-1]==="/"){t=t.slice(0,-1)}return t}function M(t){var e=t.split("="),n=e[0],r=e[1];return{key:decodeURIComponent(n),value:decodeURIComponent(r)}}function U(t){return t.replace(/^#/,"").split("&").reduce((function(t,e){var n=M(e),r=n.key,i=n.value;t[r]=i;return t}),{})}function W(t){if(t===void 0){t={}}if(t.portal){return C(t.portal)}if(t.authentication){return t.authentication.portal}return"https://www.arcgis.com/sharing/rest"}var G=/[\x00-\x1F\x7F-\x9F\xA0]/g;function F(t){return t.replace(G,"")}var L=function(t,e){var n=typeof e==="string"?e:W(e);return n+"/content/items/"+t};function H(t,e){var n=L(t,e)+"/data";var r=O({httpMethod:"GET",params:{}},e);if(r.file){r.params.f=null}return _(n,r).catch((function(t){var e=RegExp(/The string did not match the expected pattern|(Unexpected end of (JSON input|data at line 1 column 1))/i);if(e.test(t.message)){return}else throw t}))}function J(t,e){var n=L(t,e)+"/groups";return _(n,e)}function K(t,e){var n=e||{},r=n.fileName,i=r===void 0?"iteminfo.xml":r,o=n.readAs,s=o===void 0?"text":o;var a=O({httpMethod:"GET"},e);return B(t,"/info/"+i,s,a)}function V(t,e){var n=O(O({},e),{fileName:"metadata/metadata.xml"});return K(t,n)}function B(t,e,n,r){var i=""+L(t,r)+e;var o=O({params:{}},r);var s=o.rawResponse;o.rawResponse=true;o.params.f=null;return _(i,o).then((function(t){if(s){return t}return n!=="json"?t[n]():t.text().then((function(t){return JSON.parse(F(t))}))}))}function z(t,e){var n=W(e)+"/community/groups/"+t+"/userlist";var r=q(e||{},["name","num","start","sortField","sortOrder","joined","memberType"],{httpMethod:"GET"});return _(n,r)}var Y=function(){function t(t){if(t===void 0){t=""}this.termStack=[];this.rangeStack=[];this.openGroups=0;this.q=t}t.prototype.match=function(){var t=[];for(var e=0;e<arguments.length;e++){t[e]=arguments[e]}this.termStack=this.termStack.concat(t);return this};t.prototype.in=function(t){var e="`in("+(t?'"'+t+'"':"")+")`";if(!this.hasRange&&!this.hasTerms){T(e+" was called with no call to `match(...)` or `from(...)`/`to(...)`. Your query was not modified.");return this}if(t&&t!=="*"){this.q+=t+":"}return this.commit()};t.prototype.startGroup=function(){this.commit();if(this.openGroups>0){this.q+=" "}this.openGroups++;this.q+="(";return this};t.prototype.endGroup=function(){if(this.openGroups<=0){T("`endGroup(...)` was called without calling `startGroup(...)` first. Your query was not modified.");return this}this.commit();this.openGroups--;this.q+=")";return this};t.prototype.and=function(){return this.addModifier("and")};t.prototype.or=function(){return this.addModifier("or")};t.prototype.not=function(){return this.addModifier("not")};t.prototype.from=function(t){if(this.hasTerms){T('`from(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01").  Your query was not modified.');return this}this.rangeStack[0]=t;return this};t.prototype.to=function(t){if(this.hasTerms){T('`to(...)` is not allowed after `match(...)` try using `.from(...).to(...).in(...)`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01"). Your query was not modified.');return this}this.rangeStack[1]=t;return this};t.prototype.boost=function(t){this.commit();this.q+="^"+t;return this};t.prototype.toParam=function(){this.commit();this.cleanup();return this.q};t.prototype.clone=function(){this.commit();this.cleanup();return new t(this.q+"")};t.prototype.addModifier=function(t){if(this.currentModifer){T("You have called `"+this.currentModifer+"()` after `"+t+"()`. Your current query was not modified.");return this}this.commit();if(this.q===""&&t!=="not"){T("You have called `"+t+"()` without calling another method to modify your query first. Try calling `match()` first.");return this}this.currentModifer=t;this.q+=this.q===""?"":" ";this.q+=t.toUpperCase()+" ";return this};t.prototype.needsQuotes=function(t){return/\s|:/g.test(t)};t.prototype.formatTerm=function(t){if(t instanceof Date){return t.getTime()}if(typeof t==="string"&&this.needsQuotes(t)){return'"'+t+'"'}return t};t.prototype.commit=function(){var t=this;this.currentModifer=undefined;if(this.hasRange){this.q+="["+this.formatTerm(this.rangeStack[0])+" TO "+this.formatTerm(this.rangeStack[1])+"]";this.rangeStack=[undefined,undefined]}if(this.hasTerms){this.q+=this.termStack.map((function(e){return t.formatTerm(e)})).join(" ");this.termStack=[]}return this};Object.defineProperty(t.prototype,"hasTerms",{get:function(){return this.termStack.length>0},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hasRange",{get:function(){return this.rangeStack.length&&this.rangeStack[0]&&this.rangeStack[1]},enumerable:false,configurable:true});t.prototype.cleanup=function(){if(this.openGroups>0){T("Automatically closing "+this.openGroups+" group(s). You can use `endGroup(...)` to remove this warning.");while(this.openGroups>0){this.q+=")";this.openGroups--}}var t=this.q;this.q=t.replace(/( AND ?| NOT ?| OR ?)*$/,"");if(t!==this.q){T("`startGroup(...)` was called without calling `endGroup(...)` first. Your query was not modified.")}this.q=this.q.replace(/(\(\))*/,"")};return t}();function Q(t,e){var n;if(typeof t==="string"||t instanceof Y){n={httpMethod:"GET",params:{q:t}}}else{n=q(t,["q","num","start","sortField","sortOrder","searchUserAccess","searchUserName","filter","countFields","countSize","categories","categoryFilters"],{httpMethod:"GET"})}var r;switch(e){case"item":r="/search";break;case"group":r="/community/groups";break;case"groupContent":if(typeof t!=="string"&&!(t instanceof Y)&&t.groupId){r="/content/groups/"+t.groupId+"/search"}else{return Promise.reject(new Error("you must pass a `groupId` option to `searchGroupContent`"))}break;default:r="/portals/self/users/search";break}var i=W(n)+r;return _(i,n).then((function(n){if(n.nextStart&&n.nextStart!==-1){n.nextPage=function(){var r;if(typeof t==="string"||t instanceof Y){r={q:t,start:n.nextStart}}else{r=t;r.start=n.nextStart}return Q(r,e)}}return n}))}function X(t){return Q(t,"item")}function Z(t){return Q(t,"group")}function tt(t){return Q(t,"groupContent")}function et(t){var e;var n={httpMethod:"GET"};if(typeof t==="string"){e="https://www.arcgis.com/sharing/rest/community/users/"+t}else{var r=t.username||t.authentication.username;e=W(t)+"/community/users/"+encodeURIComponent(r);n=O(O({},t),n)}return _(e,n)}function nt(t){return Q(t,"user")}function rt(t,e){var n=t?t:"self";var r=W(e)+"/portals/"+n;var i=O({httpMethod:"GET"},e);return _(r,i)}function it(t,e){return e.split(".").reduce((function(t,e){return t?t[e]:undefined}),t)}function ot(t){let e={};if(Array.isArray(t)){e=t.map(ot)}else if(typeof t==="object"){for(const n in t){if(t.hasOwnProperty(n)){const r=t[n];if(r!=null&&typeof r==="object"){if(r instanceof Date){e[n]=new Date(r.getTime())}else if(typeof Blob!=="undefined"&&r instanceof Blob){e[n]=new Blob([r],{type:r.type})}else{e[n]=ot(r)}}else{e[n]=r}}}}else{e=t}return e}function st(t="i"){return`${t}${Math.random().toString(36).substr(2,8)}`}function at(t,e,n){return n.indexOf(t)===e}function ct(t,e,n={}){const r=e.split(".");let i=t;const o=r.length-1;r.forEach(((t,e)=>{if(!i.hasOwnProperty(t)||i[t]==null){if(e===o){i[t]=n}else{i[t]={}}}else if(e===o){if(typeof i[t]==="object"&&!Array.isArray(i[t])){i[t]=Object.assign(i[t],ot(n))}else{i[t]=n}}i=i[t]}))}function ut(t,e,n){const r=it(t,e);return r!==undefined?r:n}function lt(t,e,n){if(Array.isArray(t)){t=t.join(".")}ct(n,t,e)}class dt extends Error{constructor(t,e,n){e=e||"UNKNOWN_ERROR";n=ut(n,"rootCause",n);super(e);this.operation=t;this.name="OperationError";this.rootCause=n;Object.setPrototypeOf(this,dt.prototype);this.stack=ut(n,"stack",(new Error).stack)}}const ft=t=>e=>t.reduce(((t,n)=>t.then(n).catch((t=>{if(t.name==="OperationError"){return Promise.reject(t)}else{const t=`IPipeableFn did not reject with an OperationError \n Operation Stack: \n ${e.stack.toString()}`;const n=new dt("pipeline execution error",t);n.operationStack=e.stack.serialize();return Promise.reject(n)}}))),Promise.resolve(e));function pt(t,e=[]){return e.map((e=>e[t]))}function ht(t,e){var n=e;n.rawResponse=false;return _(t,n).then((function(t){var e={token:t.access_token,username:t.username,expires:new Date(Date.now()+(t.expires_in*1e3-1e3)),ssl:t.ssl===true};if(t.refresh_token){e.refreshToken=t.refresh_token}return e}))}function mt(t,e){var n=e;if(typeof window!=="undefined"&&window.location&&window.location.host){n.params.referer=window.location.host}else{n.params.referer=P}return _(t,n)}var gt=/^https?:\/\/(\S+)\.arcgis\.com.+/;function bt(t){return gt.test(t)}function vt(t){if(!gt.test(t)){return t}switch(wt(t)){case"dev":return"https://devext.arcgis.com/sharing/rest";case"qa":return"https://qaext.arcgis.com/sharing/rest";default:return"https://www.arcgis.com/sharing/rest"}}function wt(t){if(!gt.test(t)){return null}var e=t.match(gt);var n=e[1].split(".").pop();if(n.includes("dev")){return"dev"}if(n.includes("qa")){return"qa"}return"production"}function yt(t,e){var n=C(vt(e)).replace(/https?:\/\//,"");var r=C(t).replace(/https?:\/\//,"");return new RegExp(r,"i").test(n)}function kt(t,e){var n=bt(t);var r=bt(e);var i=wt(t);var o=wt(e);if(n&&r&&i===o){return true}return false}function Ot(t,e,n){if(n===void 0){n="https://www.arcgis.com/sharing/rest"}var r=n+"/oauth2/validateAppAccess";var i={method:"POST",params:{f:"json",client_id:e,token:t}};return _(r,i)}function St(){var t={promise:null,resolve:null,reject:null};t.promise=new Promise((function(e,n){t.resolve=e;t.reject=n}));return t}var Dt=function(){function t(t){this.clientId=t.clientId;this._refreshToken=t.refreshToken;this._refreshTokenExpires=t.refreshTokenExpires;this.username=t.username;this.password=t.password;this._token=t.token;this._tokenExpires=t.tokenExpires;this.portal=t.portal?C(t.portal):"https://www.arcgis.com/sharing/rest";this.ssl=t.ssl;this.provider=t.provider||"arcgis";this.tokenDuration=t.tokenDuration||20160;this.redirectUri=t.redirectUri;this.refreshTokenTTL=t.refreshTokenTTL||20160;this.server=t.server;this.federatedServers={};this.trustedDomains=[];if(t.server){var e=this.getServerRootUrl(t.server);this.federatedServers[e]={token:t.token,expires:t.tokenExpires}}this._pendingTokenRequests={}}Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"tokenExpires",{get:function(){return this._tokenExpires},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"refreshToken",{get:function(){return this._refreshToken},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"refreshTokenExpires",{get:function(){return this._refreshTokenExpires},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"trustedServers",{get:function(){console.log("DEPRECATED: use federatedServers instead");return this.federatedServers},enumerable:false,configurable:true});t.beginOAuth2=function(e,n){if(n===void 0){n=window}if(e.duration){console.log("DEPRECATED: 'duration' is deprecated - use 'expiration' instead")}var r=O({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",expiration:20160,popup:true,popupWindowFeatures:"height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes",state:e.clientId,locale:""},e),i=r.portal,o=r.provider,s=r.clientId,a=r.expiration,c=r.redirectUri,u=r.popup,l=r.popupWindowFeatures,d=r.state,f=r.locale,p=r.params;var h;if(o==="arcgis"){h=i+"/oauth2/authorize?client_id="+s+"&response_type=token&expiration="+(e.duration||a)+"&redirect_uri="+encodeURIComponent(c)+"&state="+d+"&locale="+f}else{h=i+"/oauth2/social/authorize?client_id="+s+"&socialLoginProviderName="+o+"&autoAccountCreateForSocial=true&response_type=token&expiration="+(e.duration||a)+"&redirect_uri="+encodeURIComponent(c)+"&state="+d+"&locale="+f}if(p){h=h+"&"+A(p)}if(!u){n.location.href=h;return undefined}var m=St();n["__ESRI_REST_AUTH_HANDLER_"+s]=function(e,n){if(e){var r=JSON.parse(e);m.reject(new R(r.errorMessage,r.error));return}if(n){var o=JSON.parse(n);m.resolve(new t({clientId:s,portal:i,ssl:o.ssl,token:o.token,tokenExpires:new Date(o.expires),username:o.username}))}};n.open(h,"oauth-window",l);return m.promise};t.completeOAuth2=function(e,n){if(n===void 0){n=window}var r=O({portal:"https://www.arcgis.com/sharing/rest",popup:true},e),i=r.portal,o=r.clientId,s=r.popup;function a(e,r){try{var a=void 0;var c="__ESRI_REST_AUTH_HANDLER_"+o;if(s){if(n.opener){if(n.opener.parent&&n.opener.parent[c]){a=n.opener.parent[c]}else if(n.opener&&n.opener[c]){a=n.opener[c]}}else{if(n!==n.parent&&n.parent&&n.parent[c]){a=n.parent[c]}}if(a){a(e?JSON.stringify(e):undefined,JSON.stringify(r));n.close();return undefined}}}catch(t){throw new R('Unable to complete authentication. It\'s possible you specified popup based oAuth2 but no handler from "beginOAuth2()" present. This generally happens because the "popup" option differs between "beginOAuth2()" and "completeOAuth2()".')}if(e){throw new R(e.errorMessage,e.error)}return new t({clientId:o,portal:i,ssl:r.ssl,token:r.token,tokenExpires:r.expires,username:r.username})}var c=U(n.location.hash);if(!c.access_token){var u=void 0;var l="Unknown error";if(c.error){u=c.error;l=c.error_description}return a({error:u,errorMessage:l})}var d=c.access_token;var f=new Date(Date.now()+parseInt(c.expires_in,10)*1e3-60*1e3);var p=c.username;var h=c.ssl==="true";return a(undefined,{token:d,expires:f,ssl:h,username:p})};t.fromParent=function(e,n){if(!n&&window){n=window}var r;return new Promise((function(i,o){r=function(e){if(e.source===n.parent&&e.data){try{return i(t.parentMessageHandler(e))}catch(t){return o(t)}}};n.addEventListener("message",r,false);n.parent.postMessage({type:"arcgis:auth:requestCredential"},e)})).then((function(t){n.removeEventListener("message",r,false);return t}))};t.authorize=function(t,e){if(t.duration){console.log("DEPRECATED: 'duration' is deprecated - use 'expiration' instead")}var n=O({portal:"https://arcgis.com/sharing/rest",expiration:20160},t),r=n.portal,i=n.clientId,o=n.expiration,s=n.redirectUri;e.writeHead(301,{Location:r+"/oauth2/authorize?client_id="+i+"&expiration="+(t.duration||o)+"&response_type=code&redirect_uri="+encodeURIComponent(s)});e.end()};t.exchangeAuthorizationCode=function(e,n){var r=O({portal:"https://www.arcgis.com/sharing/rest",refreshTokenTTL:20160},e),i=r.portal,o=r.clientId,s=r.redirectUri,a=r.refreshTokenTTL;return ht(i+"/oauth2/token",{params:{grant_type:"authorization_code",client_id:o,redirect_uri:s,code:n}}).then((function(e){return new t({clientId:o,portal:i,ssl:e.ssl,redirectUri:s,refreshToken:e.refreshToken,refreshTokenTTL:a,refreshTokenExpires:new Date(Date.now()+(a-1)*60*1e3),token:e.token,tokenExpires:e.expires,username:e.username})}))};t.deserialize=function(e){var n=JSON.parse(e);return new t({clientId:n.clientId,refreshToken:n.refreshToken,refreshTokenExpires:new Date(n.refreshTokenExpires),username:n.username,password:n.password,token:n.token,tokenExpires:new Date(n.tokenExpires),portal:n.portal,ssl:n.ssl,tokenDuration:n.tokenDuration,redirectUri:n.redirectUri,refreshTokenTTL:n.refreshTokenTTL})};t.fromCredential=function(e){var n=typeof e.ssl!=="undefined"?e.ssl:true;var r=e.expires||Date.now()+72e5;return new t({portal:e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest",ssl:n,token:e.token,username:e.userId,tokenExpires:new Date(r)})};t.parentMessageHandler=function(e){if(e.data.type==="arcgis:auth:credential"){return t.fromCredential(e.data.credential)}if(e.data.type==="arcgis:auth:error"){var n=new Error(e.data.error.message);n.name=e.data.error.name;throw n}else{throw new Error("Unknown message type.")}};t.prototype.toCredential=function(){return{expires:this.tokenExpires.getTime(),server:this.portal,ssl:this.ssl,token:this.token,userId:this.username}};t.prototype.getUser=function(t){var e=this;if(this._pendingUserRequest){return this._pendingUserRequest}else if(this._user){return Promise.resolve(this._user)}else{var n=this.portal+"/community/self";var r=O(O({httpMethod:"GET",authentication:this},t),{rawResponse:false});this._pendingUserRequest=_(n,r).then((function(t){e._user=t;e._pendingUserRequest=null;return t}));return this._pendingUserRequest}};t.prototype.getPortal=function(t){var e=this;if(this._pendingPortalRequest){return this._pendingPortalRequest}else if(this._portalInfo){return Promise.resolve(this._portalInfo)}else{var n=this.portal+"/portals/self";var r=O(O({httpMethod:"GET",authentication:this},t),{rawResponse:false});this._pendingPortalRequest=_(n,r).then((function(t){e._portalInfo=t;e._pendingPortalRequest=null;return t}));return this._pendingPortalRequest}};t.prototype.getUsername=function(){if(this.username){return Promise.resolve(this.username)}else if(this._user){return Promise.resolve(this._user.username)}else{return this.getUser().then((function(t){return t.username}))}};t.prototype.getToken=function(t,e){if(kt(this.portal,t)){return this.getFreshToken(e)}else if(new RegExp(this.portal,"i").test(t)){return this.getFreshToken(e)}else{return this.getTokenForServer(t,e)}};t.prototype.validateAppAccess=function(t){return this.getToken(this.portal).then((function(e){return Ot(e,t)}))};t.prototype.toJSON=function(){return{clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,refreshTokenTTL:this.refreshTokenTTL}};t.prototype.serialize=function(){return JSON.stringify(this)};t.prototype.enablePostMessageAuth=function(t,e){if(!e&&window){e=window}this._hostHandler=this.createPostMessageHandler(t);e.addEventListener("message",this._hostHandler,false)};t.prototype.disablePostMessageAuth=function(t){if(!t&&window){t=window}t.removeEventListener("message",this._hostHandler,false)};t.prototype.refreshSession=function(t){this._user=null;if(this.username&&this.password){return this.refreshWithUsernameAndPassword(t)}if(this.clientId&&this.refreshToken){return this.refreshWithRefreshToken()}return Promise.reject(new R("Unable to refresh token."))};t.prototype.getServerRootUrl=function(t){var e=C(t).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/)[0];var n=e.match(/(https?:\/\/)(.+)/),r=n[1],i=n[2];var o=i.split("/"),s=o[0],a=o.slice(1);return""+r+s.toLowerCase()+"/"+a.join("/")};t.prototype.getDomainCredentials=function(t){if(!this.trustedDomains||!this.trustedDomains.length){return"same-origin"}return this.trustedDomains.some((function(e){return t.startsWith(e)}))?"include":"same-origin"};t.prototype.createPostMessageHandler=function(t){var e=this;return function(n){var r=t.indexOf(n.origin)>-1;var i=n.data.type==="arcgis:auth:requestCredential";var o=e.tokenExpires.getTime()>Date.now();if(r&&i){var s={};if(o){var a=e.toCredential();a.server=a.server.replace("/sharing/rest","");s={type:"arcgis:auth:credential",credential:a}}else{s={type:"arcgis:auth:error",error:{name:"tokenExpiredError",message:"Session token was expired, and not returned to the child application"}}}n.source.postMessage(s,n.origin)}}};t.prototype.getTokenForServer=function(t,e){var n=this;var r=this.getServerRootUrl(t);var i=this.federatedServers[r];if(i&&i.expires&&i.expires.getTime()>Date.now()){return Promise.resolve(i.token)}if(this._pendingTokenRequests[r]){return this._pendingTokenRequests[r]}this._pendingTokenRequests[r]=this.fetchAuthorizedDomains().then((function(){return _(r+"/rest/info",{credentials:n.getDomainCredentials(t)}).then((function(i){if(i.owningSystemUrl){if(!yt(i.owningSystemUrl,n.portal)){throw new R(t+" is not federated with "+n.portal+".","NOT_FEDERATED")}else{return _(i.owningSystemUrl+"/sharing/rest/info",e)}}else if(i.authInfo&&n.federatedServers[r]!==undefined){return Promise.resolve({authInfo:i.authInfo})}else{throw new R(t+" is not federated with any portal and is not explicitly trusted.","NOT_FEDERATED")}})).then((function(t){return t.authInfo.tokenServicesUrl})).then((function(e){if(n.token&&n.tokenExpires.getTime()>Date.now()){return mt(e,{params:{token:n.token,serverUrl:t,expiration:n.tokenDuration,client:"referer"}})}else{return mt(e,{params:{username:n.username,password:n.password,expiration:n.tokenDuration,client:"referer"}}).then((function(t){n._token=t.token;n._tokenExpires=new Date(t.expires);return t}))}})).then((function(t){n.federatedServers[r]={expires:new Date(t.expires),token:t.token};delete n._pendingTokenRequests[r];return t.token}))}));return this._pendingTokenRequests[r]};t.prototype.getFreshToken=function(t){var e=this;if(this.token&&!this.tokenExpires){return Promise.resolve(this.token)}if(this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()){return Promise.resolve(this.token)}if(!this._pendingTokenRequests[this.portal]){this._pendingTokenRequests[this.portal]=this.refreshSession(t).then((function(t){e._pendingTokenRequests[e.portal]=null;return t.token}))}return this._pendingTokenRequests[this.portal]};t.prototype.refreshWithUsernameAndPassword=function(t){var e=this;var n=O({params:{username:this.username,password:this.password,expiration:this.tokenDuration}},t);return mt(this.portal+"/generateToken",n).then((function(t){e._token=t.token;e._tokenExpires=new Date(t.expires);return e}))};t.prototype.refreshWithRefreshToken=function(t){var e=this;if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()<Date.now()){return this.refreshRefreshToken(t)}var n=O({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},t);return ht(this.portal+"/oauth2/token",n).then((function(t){e._token=t.token;e._tokenExpires=t.expires;return e}))};t.prototype.refreshRefreshToken=function(t){var e=this;var n=O({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},t);return ht(this.portal+"/oauth2/token",n).then((function(t){e._token=t.token;e._tokenExpires=t.expires;e._refreshToken=t.refreshToken;e._refreshTokenExpires=new Date(Date.now()+(e.refreshTokenTTL-1)*60*1e3);return e}))};t.prototype.fetchAuthorizedDomains=function(){var t=this;if(this.server||!this.portal){return Promise.resolve(this)}return this.getPortal().then((function(e){if(e.authorizedCrossOriginDomains&&e.authorizedCrossOriginDomains.length){t.trustedDomains=e.authorizedCrossOriginDomains.filter((function(t){return!t.startsWith("http://")})).map((function(t){if(t.startsWith("https://")){return t}else{return"https://"+t}}))}return t}))};return t}();function Et(t){const{host:e,path:n,query:r}=t;const i=e.endsWith("/")?e:`${e}/`;const o=new URL(n,i);o.search=xt(r);return o.toString()}function xt(t={}){const e=Object.keys(t).filter((e=>t[e]!==undefined)).reduce(((e,n)=>{e[n]=t[n];return e}),{});return new URLSearchParams(e).toString()}function At(t){if(typeof t==="string"){return t.replace(/\/sharing\/rest\/?$/,"")}if(typeof t==="object"){const e=t.portalSelf;const n=e||t;const{portalHostname:r,urlKey:i,customBaseUrl:o}=n;if(r||i&&o){if(n.isPortal){return`https://${n.portalHostname}`}else{return`https://${n.urlKey}.${n.customBaseUrl}`}}}return At(W(t))}function $t(t){return`${At(t)}/sharing/rest`}function jt(t,e){const n=At(e);return`${n}/home/item.html?id=${t}`}const Tt=(t,e,n)=>{const{id:r,access:i}=t;const o=`${$t(e)}/content/items/${r}`;const s=new URLSearchParams({f:"json"});if(i!=="public"&&n){s.append("token",n)}return`${o}?${s.toString()}`};function Pt(t){let e=t;if(t.match(/(qaext|\.mapsqa)\.arcgis.com/)){e="https://qaext.arcgis.com"}else if(t.match(/(devext|\.mapsdevext)\.arcgis.com/)){e="https://devext.arcgis.com"}else{if(t.match(/(www|\.maps)\.arcgis.com/)){e="https://www.arcgis.com"}}return e}function Nt(t,e){const n=At(e);return`${n}/home/group.html?id=${t}`}function Rt(t,e){const n=At(e);return`${n}/home/user.html?user=${t}`}const It=["Application","City Engine Web Scene","CityEngine Web Scene","Dashboard","Insights Page","Insights Workbook","Operation View","Web Mapping Application","StoryMap","Web Experience","Urban Model"];const _t=["CSV Collection","CSV","Feature Collection Template","Feature Collection","Feature Layer","Feature Service","File Geodatabase","GeoJSON","GeoJson","KML Collection","KML","Microsoft Excel","Raster Layer","Shapefile","Stream Service","Table"];const qt=["CAD Drawing","Document Link","Hub Page","Site Page","Image","iWork Keynote","iWork Numbers","iWork Pages","Microsoft Powerpoint","Microsoft Visio","Microsoft Word","Notebook","PDF","Pro Map","Report Template"];const Ct=["Hub Event"];const Mt=["Form","Quick Capture Project"];const Ut=["Hub Initiative"];const Wt=["Solution"];const Gt=["Hub Initiative Template"];const Ft=["Image Collection","Image Service","Map Service Layer","Map Service","Scene Service","Scene Layer","Vector Tile Service","Web Map Service","Web Map Tile Service","Web Map","Web Scene","WFS","WMS","WMTS"];const Lt=["360 VR Experience","AppBuilder Widget Package","Application Configuration","ArcPad Package","Code Attachment","Code Sample","Desktop Add In","Desktop Application Template","Desktop Application","Desktop Style","Explorer Add In","Explorer Layer","Geocoding Service","Geometry Service","Geoprocessing Package","Geoprocessing Sample","Geoprocessing Service","Layer File","Layer Package","Layer Template","Layer","Layout","Locator Package","Map Area","Map Document","Map Package","Map Service Definition","Map Template","Mobile Application","Mobile Map Package","Native Application","Network Analysis Service","Operations Dashboard Add In","Project Package","Project Template","Raster Function Template","Rule Package","Scene Package","Service Definition","SQLite Geodatabase","Style","Tile Package","Vector Tile Package","Workflow Manager Package"];const Ht=["Hub Site Application","Site Application"];const Jt=t=>{if(!t){return}const e=t.toLocaleLowerCase();return Object.keys(Kt).find((t=>{const n=Kt[t];return n.some((t=>t.toLocaleLowerCase()===e))}))};const Kt={app:It,dataset:_t,document:qt,event:Ct,feedback:Mt,initiative:Ut,template:Gt,solution:Wt,map:Ft,other:Lt,site:Ht};var Vt=new RegExp(/.+(?:map|feature|image)server/i);function Bt(t){var e=t.match(Vt);if(e){return e[0]}else{return zt(t)}}function zt(t){var e=t.split("?")[0];return C(e)}function Yt(t){var e=t.url,n=S(t,["url"]);var r=Bt(e)+"/layers";return _(r,n)}function Qt(t){return _(C(t.url),t)}class Xt extends dt{constructor(t,e,n){e=e||"UNKNOWN_ERROR";n=ut(n,"rootCause",n);super(t,e,n);this.name="HubError";this.stack=ut(n,"stack",(new Error).stack)}}function Zt(t,e,n){if(!t||!t.thumbnail){return null}let{token:r,width:i}=n||{};if(!r&&typeof n==="string"){r=n}const o=Tt(t,e,r);const[s,a]=o.split("?");const c=new URLSearchParams(a);c.delete("f");if(i){c.append("w",i+"")}const u=c.toString();const l=`${s}/info/${t.thumbnail}`;return u?`${l}?${u}`:l}function te(t){const e=t.split(" AS ");const n=e[0];const r=e[1]||n.split(".").reverse()[0];const i=n.split(".")[0];const o={enrichment:i,path:n,prop:r};return o}class ee{constructor(){this.operations=[]}startOperation(t){const e=ot(t);e.startedAt=(new Date).getTime();e.state="working";this.operations.push(e)}start(t,e){const n={type:t,id:ut(e,"id",st(`${t}_`)),inputs:ut(e,"inputs",{}),cleanup:ut(e,"cleanup","n/a"),startedAt:(new Date).getTime(),state:"working"};this.operations.push(n);return n.id}getOperation(t){return this.operations.find((e=>e.id===t))}getOperations(){return this.operations}finish(t,e){const n=this.getOperation(t);if(n){n.duration=(new Date).getTime()-n.startedAt;n.state="completed";if(e){n.output=ot(e)}}else{throw new Error(`No operation with id ${t} present in stack`)}}merge(t){this.operations=[...this.operations,...t.operations]}getCompleted(){return ot(this.operations.filter((t=>t.state==="completed")))}getWorking(){return ot(this.operations.filter((t=>t.state==="working")))}toString(){const t=this.operations.sort(((t,e)=>{if(t.startedAt<e.startedAt){return-1}if(e.startedAt<t.startedAt){return 1}return 0}));return t.map(ne).join("\n")}serialize(){return{operations:ot(this.getOperations())}}}function ne(t){let e=`${t.startedAt} : Operation ${t.id} started with inputs ${JSON.stringify(t.inputs)} but was not completed`;if(t.state==="completed"){e=`${t.startedAt} : Operation ${t.id} took ${t.duration} ms with inputs ${JSON.stringify(t.inputs)} and output ${t.output?JSON.stringify(t.output):"n/a"}`}return e}function re(t,e){const n=it(e,"portal")||it(e,"authentication.portal")||"www.arcgis.com";const r=`${Pt(n)}/sharing/rest`;return rt(t,Object.assign(Object.assign({},e),{portal:r}))}async function ie(t){const{parse:e}=await import("./p-d54d09a0.js").then((function(t){return t.p}));const n={ignoreAttributes:false,attributeNamePrefix:"@_",textNodeName:"#value"};return e(t,n)}async function oe(t,e){try{const n=await V(t,e);return await ie(n)}catch(t){return null}}const se=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichGroupIds");return J(e.item.id,r).then((t=>{const{admin:o,member:s,other:a}=t;const c=[...o,...s,...a].map((t=>t.id));n.finish(i);return{data:Object.assign(Object.assign({},e),{groupIds:c}),stack:n,requestOptions:r}})).catch((e=>pe(e,t,i)))};const ae=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichMetadata");return oe(e.item.id,r).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{metadata:t}),stack:n,requestOptions:r}}))};const ce=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichOwner");const o=Object.assign({username:e.item.owner},r);return et(o).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{ownerUser:t}),stack:n,requestOptions:r}})).catch((e=>pe(e,t,i)))};const ue=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichOrg");const o=xe(e.item,e.ownerUser);const s=o?re(o,r):Promise.resolve(undefined);return s.then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{org:t}),stack:n,requestOptions:r}})).catch((e=>pe(e,t,i)))};const le=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichData");return H(e.item.id,r).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{data:t}),stack:n,requestOptions:r}})).catch((e=>pe(e,t,i)))};const de=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichServer");const o=Bt(e.item.url);const s=Object.assign(Object.assign({},r),{url:o});return Qt(s).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{server:t}),stack:n,requestOptions:r}})).catch((e=>pe(e,t,i)))};const fe=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichLayers");const o=e.item.url;const s=Object.assign(Object.assign({},r),{url:o});return Yt(s).then((t=>{const e=[...t.layers,...t.tables];return e.filter((t=>t.type!=="Group Layer"))})).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{layers:t}),stack:n,requestOptions:r}})).catch((e=>pe(e,t,i)))};const pe=(t,e,n)=>{const{data:r,stack:i,requestOptions:o}=e;i.finish(n,{error:t});return{data:Object.assign(Object.assign({},r),{errors:me(t,r.errors)}),stack:i,requestOptions:o}};const he={groupIds:se,metadata:ae,ownerUser:ce,org:ue,data:le,server:de,layers:fe};const me=(t,e=[])=>{const n=typeof t==="string"?t:t.message;return[...e,{type:"Other",message:n}]};const ge=(t,e,n)=>{const r=e.reduce(((t,e)=>{const n=he[e];n&&t.push(n);return t}),[]);const i=ft(r);return i({data:{item:t},stack:new ee,requestOptions:n}).then((t=>t.data))};function be(t){const e={other:"content",solution:"template"};return e[t]||t}function ve(t){let e;switch(t.toLowerCase()){case"image service":e="dataset";break;case"feature service":case"raster layer":e="map";break;case"microsoft excel":e="document";break;case"cad drawing":case"feature collection template":case"report template":e="content";break;case"hub project":e="project";break;default:e=be(Jt(t))}return e}async function we(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,typeKeywords:t.typeKeywords,tags:t.tags,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ve(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(at);const o=e.map(te);const s=pt("enrichment",o).filter(at);let a={};if(s.length){a=await ge(t,s,n)}o.forEach((t=>{r[t.prop]=it(a,t.path)}));r.links.thumbnail=Zt(t,n);r.links.self=jt(r.id,n);r.links.siteRelative=ke(r.type,r.id,t.typeKeywords);return r}async function ye(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,typeKeywords:t.typeKeywords,tags:t.tags,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ve(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(at);const o=e.map(te);const s=pt("enrichment",o).filter(at);let a={};if(s.length){a=await ge(t,s,n)}o.forEach((t=>{r[t.prop]=it(a,t.path)}));r.links.thumbnail=Zt(t,n);r.links.self=t.url;r.links.siteRelative=ke(r.type,r.id,t.typeKeywords);return r}const ke=(t,e,n)=>{let r=Se(t,e,n)||De(t,e,n);if(!r){const i=ve(t);const o=["app","dataset","document","map","template","project"];let s="/content";if(i==="feedback"){s="/feedback/surveys"}else if(Oe(t,n)){s="/pages"}else if(o.indexOf(i)>-1){s=`/${i}s`}r=`${s}/${e}`}return r};const Oe=(t,e=[])=>["Hub Page","Site Page"].includes(t)||e.includes("hubPage");const Se=(t,e,n)=>{let r;if(t==="Solution"){if((n===null||n===void 0?void 0:n.indexOf("Deployed"))>-1){r=`/content/${e}/about`}else{r=`/templates/${e}/about`}}else if(t==="Web Mapping Application"&&(n===null||n===void 0?void 0:n.indexOf("hubSolutionTemplate"))>-1){r=`/templates/${e}/about`}return r};const De=(t,e,n)=>{if(t==="Hub Initiative"&&(n===null||n===void 0?void 0:n.indexOf("hubInitiativeTemplate"))>-1||t==="Hub Initiative Template"){return`/initiatives/templates/${e}/about`}};var Ee;(function(t){t["Year"]="year";t["Month"]="month";t["Day"]="day";t["Time"]="time"})(Ee||(Ee={}));const xe=(t,e)=>t.orgId||(e===null||e===void 0?void 0:e.orgId);class Ae extends Error{constructor(t,e,n){super(t);this.status=n;this.url=e}}async function $e(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,tags:t.tags,typeKeywords:t.typeKeywords,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ve(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(at);const o=e.map(te);const s=pt("enrichment",o).filter(at);let a={};if(s.length){a=await ge(t,s,n)}o.forEach((t=>{r[t.prop]=it(a,t.path)}));r.links.thumbnail=Zt(t,n);r.links.self=jt(r.id,n);r.links.siteRelative=ke(r.type,r.id,t.typeKeywords);return r}const je=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichGroupContentCount");const o=Object.assign({groupId:e.group.id,num:1},r);return tt(o).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{contentCount:t.total}),stack:n,requestOptions:r}})).catch((e=>Pe(e,t,i)))};const Te=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichGroupContentCount");const o=Object.assign({num:3},r);return z(e.group.id,o).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{membershipSummary:{total:t.total,users:t.users}}),stack:n,requestOptions:r}})).catch((e=>Pe(e,t,i)))};const Pe=(t,e,n)=>{const{data:r,stack:i,requestOptions:o}=e;i.finish(n,{error:t});return{data:Object.assign(Object.assign({},r),{errors:me(t,r.errors)}),stack:i,requestOptions:o}};const Ne={membershipSummary:Te,contentCount:je};function Re(t,e,n){const r=e.reduce(((t,e)=>{const n=Ne[e];n&&t.push(n);return t}),[]);const i=ft(r);return i({data:{group:t},stack:new ee,requestOptions:n}).then((t=>t.data))}const Ie={arcgis:{label:"ArcGIS Online",url:"https://www.arcgis.com",type:"arcgis"},arcgisQA:{label:"ArcGIS Online QAEXT",url:"https://qaext.arcgis.com",type:"arcgis"},arcgisDEV:{label:"ArcGIS Online DEVEXT",url:"https://devext.arcgis.com",type:"arcgis"},hub:{label:"ArcGIS Hub",url:"https://hub.arcgis.com/api",type:"arcgis-hub"},hubDEV:{label:"ArcGIS Hub DEV",url:"https://hubdev.arcgis.com/api",type:"arcgis-hub"},hubQA:{label:"ArcGIS Hub QA",url:"https://hubqa.arcgis.com/api",type:"arcgis-hub"}};function _e(t){if(typeof t==="string"&&t in Ie){return Ie[t]}else{return t}}function qe(t){let e={};if(Array.isArray(t)){e={any:t}}else{if(typeof t==="string"){e={any:[t]}}if(typeof t==="object"){e=t}}return e}function Ce(t){const e={min:1e3*60,hours:1e3*60*60,days:1e3*60*60*24,weeks:1e3*60*60*24*7};const n=new Date;const r={type:"date-range",from:n.getTime(),to:n.getTime()};switch(t.unit){case"hours":case"days":case"weeks":r.from=r.to-e[t.unit]*t.num;break;case"months":n.setMonth(n.getMonth()-t.num);r.from=n.getTime();break;case"years":n.setFullYear(n.getFullYear()-t.num);r.from=n.getTime();break}return r}function Me(t,e,n,r){const i=ot(t);if(t.authentication){i.authentication=Dt.deserialize(t.authentication.serialize())}i.start=e>-1?e:n+1;return t=>{if(t){i.authentication=t}return r(i)}}function Ue(t,e,n){let r=null;if(e.thumbnail){r=`${t}/community/groups/${e.id}/info/${e.thumbnail}`;if(n&&e.access!=="public"){r=`${r}?token=${n}`}}return r}function We(t,e,n){let r=null;if(e.thumbnail){r=`${t}/community/users/${e.username}/info/${e.thumbnail}`;if(n&&e.access!=="public"){r=`${r}?token=${n}`}}return r}function Ge(t){const e={};const n=["created","modified","lastlogin"];const r=["filterType","categoriesAsParam","categoryFilter","term","searchUserAccess","isopendata","searchUserName"];const i=[...n,...r];Object.entries(t).forEach((([o,s])=>{if(!i.includes(o)){lt(o,qe(s),e)}if(n.includes(o)){const n=ot(it(t,o));if(it(t,`${o}.type`)==="relative-date"){lt(o,Ce(n),e)}else{lt(o,n,e)}}if(r.includes(o)&&t.hasOwnProperty(o)){lt(o,s,e)}}));return e}function Fe(t){const e=t.filters.map(Je);const n=e.filter(Le);const r=He(n,"AND");return r}function Le(t){return!(typeof t==="undefined"||t===null||t==="")}function He(t,e){const n=t.reduce(((t,n)=>{Object.entries(n).forEach((([n,r])=>{if(t[n]&&r!==""){t[n]=`${t[n]} ${e} ${r}`}else{if(r!==""){t[n]=r}}}));return t}),{q:""});return n}function Je(t){const e=t.operation||"AND";const n=t.predicates.map(Ge);const r=n.map(Ke).filter((t=>t!==undefined&&t!==null));const i=He(r,e);if(n.length>1){i.q=`(${i.q})`}return i}function Ke(t){const e=["created","modified"];const n=["isopendata"];const r=["searchUserAccess","searchUserName","categoriesAsParam","categoryFilter"];const i=["filterType","term",...e,...n,...r];const o=["access","capabilities","created","categories","categoriesAsParam","categoryFilter","description","disabled","email","emailstatus","firstname","fullname","group","id","isInvitationOnly","isopendata","joined","lastlogin","lastname","memberType","modified","name","orgid","orgIds","owner","provider","role","searchUserAccess","searchUserName","snippet","tags","term","title","type","typekeywords","userlicensetype","username"];const s=Object.entries(t).map((([t,s])=>{if(o.includes(t)){const o={q:""};if(!i.includes(t)&&t!=="term"){o.q=Ve(t,s)}if(e.includes(t)){o.q=Be(t,s)}if(n.includes(t)){o.q=`${t}:${s}`}if(r.includes(t)){o[t]=s}if(t==="term"){o.q=s}return o}})).filter(Le);if(s.length){const t=He(s,"AND");if(t.q){t.q=`(${t.q})`}return t}else{return null}}function Ve(t,e){let n="";if(e.any){n=`${ze("OR",t,e.any)}`}if(e.all){n=(n?n+" AND ":"")+`${ze("AND",t,e.all)}`}if(e.not){n=(n?n+" AND ":"")+`${ze("OR",`-${t}`,e.not)}`}return n}function Be(t,e){return`${t}:[${e.from} TO ${e.to}]`}function ze(t,e,n){let r="";if(Array.isArray(n)){r=`${e}:"${n.join(`" ${t} ${e}:"`)}"`;if(n.length>1){r=`(${r})`}}else{r=`${e}:"${n}"`}return r}async function Ye(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,typeKeywords:t.typeKeywords,tags:t.tags,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ve(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(at);const o=e.map(te);const s=pt("enrichment",o).filter(at);let a={};if(s.length){a=await ge(t,s,n)}o.forEach((t=>{r[t.prop]=it(a,t.path)}));r.links.thumbnail=Zt(t,n);r.links.self=jt(r.id,n);r.links.siteRelative=ke(r.type,r.id,t.typeKeywords);return r}function Qe(t){var e;if((e=t.aggregations)===null||e===void 0?void 0:e.counts){return t.aggregations.counts.map((t=>({mode:"terms",field:t.fieldName,values:t.fieldValues})))}else{return[]}}async function Xe(t,e){var n;if(!e.requestOptions){throw new Xt("portalSearchItems","options.requestOptions is required.")}const r=nn(t);r.filters=r.filters.map((t=>{t.predicates=t.predicates.map(Ge);return t}));const i=Fe(r);const o=["num","sortField","sortOrder","include","start","requestOptions"];o.forEach((t=>{if(e.hasOwnProperty(t)){i[t]=e[t]}}));if(e.requestOptions.authentication){i.authentication=e.requestOptions.authentication}else{i.portal=e.requestOptions.portal}if((n=e.aggFields)===null||n===void 0?void 0:n.length){i.countFields=e.aggFields.join(",");i.countSize=e.aggLimit||10}return Ze(i)}async function Ze(t){const e=await X(t);const n=e=>tn(e,t.includes,t.requestOptions);const r=await Promise.all(e.results.map(n));const i=Qe(e);return{total:e.total,results:r,aggregations:i,hasNext:e.nextStart>-1,next:Me(t,e.nextStart,e.total,Ze)}}async function tn(t,e=[],n){let r=$e;switch(t.type){case"Hub Site Application":case"Site Application":r=ye;break;case"Hub Page":case"Site Page":r=Ye;break;case"Hub Project":r=we;break;case"Web Mapping Application":if(t.typeKeywords.includes("hubSite")){r=ye}break}return r(t,e,n)}const en={$application:[{type:{any:["Web Mapping Application","Application","Insights","Web Experience"],not:["Insights Theme","Insights Model"]},typekeywords:{not:["hubSite","Story Map"]}},{type:"Web Mapping Experience",typekeywords:"EXB Experience"}],$dashboard:[{type:{any:["Dashboard"],not:["Operation View"]},typekeywords:{not:["Extension","ArcGIS Operation View"]}}],$dataset:[{type:{any:["Scene Service","Feature Collection","Route Layer","Layer","Explorer Layer","Tile Package","Vector Tile Package","Scene Package","Layer Package","Feature Service","Stream Service","Map Service","Vector Tile Service","Image Service","WMS","WFS","WMTS","KML","KML Collection","Globe Service","CSV","Shapefile","GeoJson","Service Definition","File Geodatabase","CAD Drawing","Relational Database Connection"],not:["Web Mapping Application","Geodata Service"]}},{typekeywords:["OGC","Geodata Service"]}],$document:[{type:["PDF","Microsoft Excel","Microsoft Word","Microsoft Powerpoint","iWork Keynote","iWork Pages","iWork Numbers","Visio Document","Document Link"]}],$initiative:[{type:"Hub Initiative"}],$experience:[{type:"Web Experience"}],$feedback:[{type:"Form"}],$page:[{typekeywords:"hubPage"}],$site:[{type:["Hub Site Application","Site Application"]}],$storymap:[{type:"Storymap"},{type:"Web Mapping Application",typekeywords:"Story Map"}],$template:[{type:["Web Mapping Application","Hub Initiative","Hub Initiative Template","Solution"],typekeywords:{any:["hubInitiativeTemplate","hubSolutionTemplate","Template"],not:"Deployed"}}],$webmap:[{type:{any:["Web Map","Web Scene"],not:"Web Mapping Application"}}]};function nn(t){const e=ot(t);e.filters=e.filters.map((t=>{let e=false;t.predicates=t.predicates.reduce(((t,n)=>{if(rn(n.type)){const r=on(n.type);t=[...t,...r];e=true}else{t.push(n)}return t}),[]);if(e){t.operation="OR"}return t}));return e}function rn(t){let e=false;if(typeof t==="string"){e=t in en}return e}function on(t){return en[t]}function sn(t){const e=t.aggregations.aggregations.map((t=>({mode:"terms",field:t.field,values:t.aggregations.map((t=>({value:t.label,count:t.value})))})));return{total:0,results:[],hasNext:false,next:()=>null,aggregations:e}}function an(t,e){const n=`terms(fields=(${e.aggFields.join()}))`;const r=it(e,"requestOptions.authentication.token");return{aggregations:n,token:r}}function cn(t){const e=Object.entries(t).filter((([t,e])=>!!e)).map((([t,e])=>`${t}=${e}`)).join("&");return e&&`?${e}`}async function un(t,e,n){var r;const i=((r=n.requestOptions)===null||r===void 0?void 0:r.fetch)||fetch;const o=t+cn(e);const s=await i(o,{method:"GET"});if(!s.ok){throw new Ae(s.statusText,o,s.status)}return s.json()}async function ln(t,e){const n=e.api;const r=`${n.url}/aggregations`;const i=an(t,e);const o=await un(r,i,e);return sn(o)}function dn(t,e,n){const r=t.links.find((t=>t.rel==="next"));let i=()=>null;if(r){i=()=>{const t=new URL(r.href);const i=+t.searchParams.get("startindex");const o=Object.assign(Object.assign({},n),{start:i});return jn(e,o)}}return i}function fn(t,e,n){const r=t.properties;return tn(r,e,n)}async function pn(t,e,n){const r=await Promise.all(t.features.map((t=>fn(t,n.include,n.requestOptions))));const i=dn(t,e,n);const o=t.links.find((t=>t.rel==="next"));return{total:t.numberMatched,results:r,hasNext:!!o,next:i}}function hn(t){return t.filters.map(mn).filter((t=>t!=="()")).join(" AND ")}function mn(t){const e=t.operation||"OR";const n=t.predicates.map(gn).filter((t=>t!=="()")).join(` ${e} `);return`(${n})`}function gn(t){const e=Object.entries(t).filter((([t,e])=>t!=="term"&&!!e)).reduce(((t,[e,n])=>{let r;if(typeof n==="string"){r=wn(e,n)}else if(Array.isArray(n)){r=yn(e,n)}else if(bn(n)){r=vn(e,n)}else{r=kn(e,n)}t.push(r);return t}),[]).join(" AND ");return`(${e})`}function bn(t){return Number.isInteger(t.from)&&Number.isInteger(t.to)}function vn(t,e){return`${t} BETWEEN ${e.from} AND ${e.to}`}function wn(t,e){return`${t}=${En(e)}`}function yn(t,e){const n=e.map(En);return`${t} IN (${n.join(", ")})`}function kn(t,e){const n=On(t,e.any);const r=Sn(t,e.all);const i=Dn(t,e.not);return[n,r,i].filter((t=>!!t)).join(" AND ")}function On(t,e){let n;if(Array.isArray(e)){const r=e.map(En);n=`${t} IN (${r.join(", ")})`}else if(e){n=wn(t,e)}return n}function Sn(t,e){let n;if(Array.isArray(e)){n=e.map((e=>wn(t,e))).join(" AND ")}else if(e){n=wn(t,e)}return n}function Dn(t,e){let n;if(e){const r=Array.isArray(e)?e:[e];const i=r.map(En);n=`${t} NOT IN (${i.join(", ")})`}return n}function En(t){const e=/\s/;return e.test(t)?`'${t}'`:t}function xn(t){const e=t.filters.filter((t=>t.predicates.find((t=>!!t.term))));const n=An(e);return n===null||n===void 0?void 0:n.term}function An(t){let e;if(t.length>1){throw new Error(`IQuery can only have 1 IFilter with a 'term' predicate but ${t.length} were detected`)}if(t.length){const n=t[0];const r=n.predicates.filter((t=>!!t.term));if(r.length>1){throw new Error(`IQuery can only have 1 'term' predicate but ${r.length} were detected`)}if(n.operation!=="AND"&&n.predicates.length>1){throw new Error(`'term' predicates cannot be OR'd to other predicates`)}const i=r[0];if(typeof i.term!=="string"){throw new Error(`'term' predicate must have a string value, string[] and IMatchOptions are not allowed.`)}e=i}return e}function $n(t,e){const n=hn(t);const r=it(e,"requestOptions.authentication.token");const i=e.num;const o=e.start;const s=xn(t);return{filter:n,token:r,limit:i,startindex:o,q:s}}async function jn(t,e){const n=e.api;const r=`${n.url}/items`;const i=$n(t,e);const o=await un(r,i,e);return pn(o,t,e)}async function Tn(t,e){var n;if(!e.useBeta){throw new Error("Not implemented")}return((n=e.aggFields)===null||n===void 0?void 0:n.length)?ln(t,e):jn(t,e)}async function Pn(t,e){if(!e.requestOptions){throw new Xt("portalSearchGroups","options.requestOptions is required.")}t.filters=t.filters.map((t=>{t.predicates=t.predicates.map(Ge);return t}));const n=Fe(t);const r=["num","sortField","sortOrder","include","start","requestOptions"];r.forEach((t=>{if(e.hasOwnProperty(t)){n[t]=e[t]}}));if(e.requestOptions.authentication){n.authentication=e.requestOptions.authentication}else{n.portal=e.requestOptions.portal}return Nn(n)}async function Nn(t){const e=await Z(t);const n=e=>Rn(e,t.include,t.requestOptions);const r=await Promise.all(e.results.map(n));return{total:e.total,results:r,hasNext:e.nextStart>-1,next:Me(t,e.nextStart,e.total,Nn)}}async function Rn(t,e=[],n){return Ln(t,e,n)}const In=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichUserOrg");const o=Object.assign(Object.assign({},r),{portal:`${Pt(r.portal)}/sharing/rest`});return re(e.user.orgId,o).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{org:t}),stack:n,requestOptions:r}})).catch((e=>_n(e,t,i)))};const _n=(t,e,n)=>{const{data:r,stack:i,requestOptions:o}=e;i.finish(n,{error:t});return{data:Object.assign(Object.assign({},r),{errors:me(t,r.errors)}),stack:i,requestOptions:o}};const qn={org:In};function Cn(t,e,n){const r=e.reduce(((t,e)=>{const n=qn[e];n&&t.push(n);return t}),[]);const i=ft(r);return i({data:{user:t},stack:new ee,requestOptions:n}).then((t=>t.data))}async function Mn(t,e,n){const r={access:t.access,id:t.username,type:"User",name:t.fullName,owner:t.username,summary:t.description,createdDate:new Date(t.created),createdDateSource:"user.created",updatedDate:new Date(t.modified),updatedDateSource:"user.modified",family:"people",links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=["org.name AS orgName"];e=[...i,...e].filter(at);const o=e.map(te);const s=pt("enrichment",o).filter(at);let a={};if(s.length){a=await Cn(t,s,n)}o.forEach((t=>{r[t.prop]=it(a,t.path)}));const c=n.authentication.token;r.links.thumbnail=We(n.portal,t,c);r.links.self=Rt(r.id,n);r.links.siteRelative=`/people/${r.id}`;return r}async function Un(t,e){if(!e.requestOptions){throw new Xt("portalSearchUsers","requestOptions: IHubRequestOptions is required.")}if(!e.requestOptions.authentication){throw new Xt("portalSearchUsers","requestOptions must pass authentication.")}t.filters=t.filters.map((t=>{t.predicates=t.predicates.map(Ge);return t}));const n=Fe(t);const r=["num","sortField","sortOrder","include","start","requestOptions"];r.forEach((t=>{if(e.hasOwnProperty(t)){n[t]=e[t]}}));n.authentication=e.requestOptions.authentication;return Wn(n)}async function Wn(t){const e=await nt(t);const n=e=>Gn(e,t.include,t.requestOptions);const r=await Promise.all(e.results.map(n));return{total:e.total,results:r,hasNext:e.nextStart>-1,next:Me(t,e.nextStart,e.total,Wn)}}async function Gn(t,e=[],n){return Mn(t,e,n)}async function Fn(t,e){if(!t){throw new Xt("hubSearch","Query is required.")}if(!t.filters||!t.filters.length){throw new Xt("hubSearch","Query must contain at least one Filter.")}if(!e.requestOptions){throw new Xt("hubSearch","requestOptions: IHubRequestOptions is required.")}if(!e.include){e.include=[]}const n=t.targetEntity;const r=_e(e.api||"arcgis").type;const i={arcgis:{item:Xe,group:Pn,user:Un},"arcgis-hub":{item:Tn}};const o=it(i,`${r}.${n}`);if(!o){throw new Xt(`hubSearch`,`Search via "${n}" filter against "${r}" api is not implemented. Please ensure "targetEntity" is defined on the query.`)}return o(ot(t),e)}async function Ln(t,e,n){const r={access:t.access,id:t.id,type:"Group",name:t.title,owner:t.owner,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"group.created",updatedDate:new Date(t.modified),updatedDateSource:"group.modified",family:"team",links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};r.isSharedUpdate=(t.capabilities||[]).includes("updateitemcontrol");r.membershipAccess=t.membershipAccess;r.isOpenData=!!t.isOpenData;const i=[];e=[...i,...e].filter(at);const o=e.map(te);const s=pt("enrichment",o).filter(at);let a={};if(s.length){a=await Re(t,s,n)}o.forEach((t=>{r[t.prop]=it(a,t.path)}));r.links.thumbnail=Ue(n.portal,t);r.links.self=Nt(r.id,n);r.links.siteRelative=`/teams/${r.id}`;return r}class Hn extends Ae{constructor(t,e,n,r){super(t,e,n);this.error=r}}function Jn(t){const{token:e,authentication:n}=t;let r=()=>Promise.resolve(e);if(n){r=n.getToken.bind(n,n.portal)}return r()}function Kn(t,e,n){const r=new Headers(e.headers);r.append("Content-Type","application/json");if(n){r.append("Authorization",`Bearer ${n}`)}const i={headers:r,method:e.httpMethod||"GET",mode:e.mode,cache:e.cache,credentials:e.credentials};const o=Et({host:e.hubApiUrl||"https://hub.arcgis.com",path:"/api/discussions/v1"});if(e.data){if(e.httpMethod==="GET"){const n=new URLSearchParams(e.data).toString();t+=`?${n}`}else{i.body=JSON.stringify(e.data)}}const s=[o.replace(/\/$/,""),t.replace(/^\//,"")].join("/");return fetch(s,i).then((t=>{if(t.ok){return t.json()}else{const{statusText:e,status:n}=t;return t.json().then((t=>{throw new Hn(e,s,n,JSON.stringify(t.message))}))}}))}function Vn(t,e){return Jn(e).then((n=>Kn(t,e,n)))}function Bn(t){const e=`/posts`;t.httpMethod="GET";return Vn(e,t)}function zn(t){const e=`/posts`;return Vn(e,Object.assign({httpMethod:"POST"},Yn(t)))}function Yn(t){const{mentionUrl:e}=t,n=S(t,["mentionUrl"]);if(e){n.headers=Object.assign(Object.assign({},n.headers),{"mention-url":e})}return n}function Qn(t){t.httpMethod="GET";return Vn(`/channels`,t)}function Xn(t){t.httpMethod="POST";return Vn(`/channels`,t)}var Zn;(function(t){t["ASC"]="ASC";t["DESC"]="DESC"})(Zn||(Zn={}));var tr;(function(t){t["THUMBS_UP"]="thumbs_up";t["THUMBS_DOWN"]="thumbs_down";t["THINKING"]="thinking";t["HEART"]="heart";t["ONE_HUNDRED"]="one_hundred";t["SAD"]="sad";t["LAUGH"]="laugh";t["SURPRISED"]="surprised"})(tr||(tr={}));var er;(function(t){t["PUBLIC"]="public";t["ORG"]="org";t["PRIVATE"]="private"})(er||(er={}));var nr;(function(t){t["PENDING"]="pending";t["APPROVED"]="approved";t["REJECTED"]="rejected";t["DELETED"]="deleted";t["HIDDEN"]="hidden"})(nr||(nr={}));var rr;(function(t){t["GROUP"]="group";t["CONTENT"]="content"})(rr||(rr={}));var ir;(function(t){t["HUB"]="hub";t["AGO"]="ago";t["URBAN"]="urban"})(ir||(ir={}));var or;(function(t){t["REPLIES"]="replies";t["REACTIONS"]="reactions";t["PARENT"]="parent";t["CHANNEL"]="channel"})(or||(or={}));var sr;(function(t){t["POST"]="post"})(sr||(sr={}));var ar;(function(t){t["HAS_USER_POSTS"]="has_user_posts"})(ar||(ar={}));var cr;(function(t){t["CREATED_AT"]="createdAt";t["CREATOR"]="creator";t["EDITOR"]="editor";t["ID"]="id";t["UPDATED_AT"]="updatedAt"})(cr||(cr={}));var ur;(function(t){t["READ"]="read";t["WRITE"]="write";t["READWRITE"]="readWrite";t["MODERATE"]="moderate";t["MANAGE"]="manage";t["OWNER"]="owner"})(ur||(ur={}));var lr;(function(t){t["BODY"]="body";t["CHANNEL_ID"]="channelId";t["CREATED_AT"]="createdAt";t["CREATOR"]="creator";t["DISCUSSION"]="discussion";t["EDITOR"]="editor";t["ID"]="id";t["PARENT_ID"]="parentId";t["STATUS"]="status";t["TITLE"]="title";t["UPDATED_AT"]="updatedAt"})(lr||(lr={}));var dr;(function(t){t["Text"]="text";t["Announcement"]="announcement";t["Poll"]="poll";t["Question"]="question"})(dr||(dr={}));var fr;(function(t){t["ACCESS"]="access";t["CREATED_AT"]="createdAt";t["CREATOR"]="creator";t["EDITOR"]="editor";t["ID"]="id";t["LAST_ACTIVITY"]="last_activity";t["UPDATED_AT"]="updatedAt"})(fr||(fr={}));var pr;(function(t){t["SETTINGS"]="settings";t["CHANNEL_ACL"]="channelAcl"})(pr||(pr={}));var hr;(function(t){t["GROUP"]="group";t["ORG"]="org";t["USER"]="user";t["ANONYMOUS_USER"]="anonymousUser";t["AUTHENTICATED_USER"]="authenticatedUser"})(hr||(hr={}));var mr;(function(t){t["ADMIN"]="admin";t["MEMBER"]="member"})(mr||(mr={}));const gr=":host{display:block}";const br=class{constructor(e){t(this,e);this.groups=[]}async componentWillRender(){this.groups=await this.getGroups(v.user)}async getGroups(t){if(!t){return[]}const e=(new Y).match(t.username).in("owner");const n=await Z({q:e,portal:`${v.app.portal}/sharing`});console.log({groups:n});return n.results}async requestChannel(t){const e={access:er.PUBLIC,groups:[t],defaultPostStatus:nr.APPROVED};console.debug("createChannel",{groupId:t});const n=Xn(Object.assign({data:e},v.context.hubRequestOptions));console.debug("createChannel",{response:n})}render(){return e(n,null,e("slot",null),e("calcite-list",null,this.groups.map((t=>e("calcite-list-item",{label:t.title,description:t.snippet},e("calcite-avatar",{scale:"m",slot:"content-start",thumbnail:"https://www.seekpng.com/png/detail/90-906849_89kib-1024x631-finn-finn-adventure-time-face.png"}),e("calcite-dropdown",{scale:"m",slot:"actions-end"},e("calcite-action",{icon:"ellipsis",label:"menu",slot:"dropdown-trigger"}),e("calcite-dropdown-group",null,e("calcite-dropdown-item",{id:`group-${t.id}`,onclick:()=>{this.requestChannel(t.id)}},"Create Channel"))))))))}};br.style=gr;const vr=":host{display:block}";const wr=class{constructor(e){t(this,e);this.channels=[]}async componentWillLoad(){this.channels=await this.getChannels()}async getChannels(){const t={};const e=await Qn(Object.assign({data:t},v.context.hubRequestOptions));return e.items}render(){console.log("Render channels",this.channels);return e(n,null,e("slot",null),e("calcite-list",null,this.channels.map((t=>e("calcite-list-item",{label:t.id,description:`Channel creator: ${t.creator}`},e("calcite-icon",{scale:"s",icon:"speech-bubble",slot:"content-start"}))))))}};wr.style=vr;const yr=[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"week",seconds:604800},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60},{label:"second",seconds:1}];const kr=t=>{const e=Math.floor(((new Date).valueOf()-new Date(t).valueOf())/1e3);const{interval:n,unit:r}=Or(e);const i=n===1?"":"s";return`${n} ${r}${i} ago`};const Or=t=>{for(let{label:e,seconds:n}of yr){const r=Math.floor(t/n);if(r>=1){return{interval:r,unit:e}}}return{interval:0,unit:""}};const Sr=":host{display:block}#posts{min-height:calc(100vh-70px);overflow-y:scroll}#editor{height:70px;bottom:0px;position:sticky;background-color:white}";const Dr=class{constructor(e){t(this,e);this.channelId=null;this.posts=[]}async componentWillLoad(){this.posts=await this.getChannelPosts(this.channelId)}async getChannelPosts(t){console.debug("getChannelPosts",{channel:t});const e={channels:[this.channelId]};const n=await Bn(Object.assign({data:e},v.context.hubRequestOptions));return n.items}render(){console.log("Render posts",this.posts);return e(n,null,e("slot",null),e("calcite-list",{id:"posts"},this.posts.map((t=>e("calcite-list-item",{description:t.creator,label:t.body},e("calcite-icon",{scale:"s",icon:"speech-bubble",slot:"content-start"}),e("div",{slot:"content-end"},kr(t.createdAt),e("calcite-chip",{class:"list-chip",icon:"organization",scale:"s"},"Staff")))))),e("hub-discussions-post-editor",{id:"editor","channel-id":this.channelId}))}};Dr.style=Sr;const Er=":host{display:block;padding:0.2rem}#prompt{font-weight:400;font-style:italic}";const xr=class{constructor(e){t(this,e);this.channelId=null}componentDidRender(){console.log("postEditor did render",this.postBodyInput)}postSubmitted(t){console.log("postSubmitted",{value:this.postBodyInput.value,_evt:t});this.createPost(this.postBodyInput.value)}async createPost(t){const e={channelId:this.channelId,body:t};const n=zn(Object.assign({data:e},v.context.hubRequestOptions));return n}render(){return e(n,null,e("slot",null),e("calcite-label",null,e("span",{id:"prompt"},"What's on your mind?"),e("calcite-input",{id:"input-with-text-area",type:"input",value:"",placeholder:"Write your discussion post.",alignment:"start","number-button-type":"vertical",scale:"m",status:"idle",ref:t=>this.postBodyInput=t},e("calcite-button",{slot:"action",onclick:this.postSubmitted.bind(this)},"post")),e("calcite-input-message",{status:"idle",scale:"m"},"help")))}};xr.style=Er;const Ar=":host{display:block}.entry{display:block;border-bottom:1px solid gray;padding:0.5rem 0.2rem}.title{font-weight:500}.timestamp{font-size:0.6rem;font-weight:300;margin-left:0.2rem}";const $r=class{constructor(e){t(this,e);this.collection=null;this.entries=[]}async componentWillRender(){await this.fetchResults()}async fetchResults(){var t,e;if(!!((t=this.collection)===null||t===void 0?void 0:t.scope)){const t=(e=this.collection)===null||e===void 0?void 0:e.scope;const n={sortOrder:"desc",sortField:"modified",requestOptions:v.context.hubRequestOptions};const r=await Fn(t,n);this.entries=r.results}}render(){var t;return e(n,null,e("slot",null),e("calcite-list",null,(t=this.entries)===null||t===void 0?void 0:t.map((t=>e("calcite-list-item",{label:t.name,description:kr(t.updatedDate)},e("calcite-icon",{scale:"s",icon:"files",slot:"content-start"}),e("calcite-dropdown",{scale:"m",slot:"actions-end"},e("calcite-action",{icon:"ellipsis",label:"menu",slot:"dropdown-trigger"}),e("calcite-dropdown-group",null,e("calcite-dropdown-item",{onclick:()=>{window.open(`${v.context.hubUrl}/content/${t.id}`,"_blank")}},"View Item"))))))))}};$r.style=Ar;const jr=":host{display:block}";const Tr=class{constructor(e){t(this,e);this.statusUrl="https://arcgis.github.io/hub-status/status.json";this.status={}}componentDidLoad(){this.fetchStatus()}async fetchStatus(){let t=await fetch(this.statusUrl);let e=await t.json();this.status=e}render(){var t,r,i,o;return e(n,null,e("ul",null,e("li",null,"Overall: ",(r=(t=this.status)===null||t===void 0?void 0:t.overview)===null||r===void 0?void 0:r.status),(o=(i=this.status)===null||i===void 0?void 0:i.services)===null||o===void 0?void 0:o.map((t=>e("li",null,t["Service Name"],": ",t["Status"])))))}};Tr.style=jr;const Pr=":host{display:block;padding:0.5rem}";const Nr=class{constructor(e){t(this,e)}render(){return e(n,null,e("slot",null))}};Nr.style=Pr;function Rr(t){var e,n;const r={key:"collection",label:"collection",targetEntity:(e=t.type)!==null&&e!==void 0?e:"item",scope:{targetEntity:(n=t.type)!==null&&n!==void 0?n:"item",filters:[{predicates:[]}]}};if(!!t.query){r.scope.filters[0].predicates.push({term:t.query})}if(!!t.groups){r.scope.filters[0].predicates.push({group:t.groups})}return r}const Ir=':host{display:block;overflow:scroll}.workspace{display:grid;grid-template-columns:10rem auto;grid-template-rows:auto;grid-template-areas:"global global"\n    "header header"\n    "navigation space"\n    "footer footer"}#global{grid-area:global;background-color:#4e4e4e}#header{grid-area:header;border-bottom:1px solid gray;display:none}#navigation{grid-area:navigation;border-right:1px solid gray}#footer{grid-area:footer;border-top:1px solid gray;background-color:#fefefe;padding:2rem;margin-top:1rem}#space{grid-area:space}#space div{display:grid;grid-template-columns:repeat( auto-fit, minmax(300px, 1fr) );gap:10px;grid-auto-rows:minmax(100px, auto);padding:1rem}';const _r=class{constructor(e){t(this,e)}render(){return e(n,null,e("div",{class:"workspace"},e("div",{id:"global"},e("workspace-navigation",null)),e("div",{id:"header"},e("slot",{name:"header"})),e("div",{id:"navigation"},"navigation"),e("div",{id:"space"},!!v.user?this.renderWorkspace():[]),e("div",{id:"footer"},e("em",null,"footer..."))))}renderWorkspace(){return e("div",null,e("workspace-card",null,e("span",{slot:"title"},"About this Workspace"),e("hub-text",null,"Personalized workspace for ",v.user.fullName,". There is quick access to my favorites, specific project discussions, and recent content.")),e("workspace-card",null,e("span",{slot:"title"},"Project Discussion"),e("hub-discussions-moderation",{"channel-id":"0311a680ff1b44389ad0392f94d5bbbb"})),e("workspace-card",null,e("span",{slot:"title"},"Recent Updates"),e("hub-feed",{collection:Rr({query:["Initiative"],type:"item"})})),e("workspace-card",null,e("span",{slot:"title"},"Favorites"),e("hub-feed",{collection:Rr({groups:[v.user.favGroupId],type:"item"})})),e("workspace-card",null,e("span",{slot:"title"},"Engagement Stats"),e("hub-activity-stats",null)),e("workspace-card",null,e("span",{slot:"title"},"Nearby"),e("em",null,"map coming...")),e("workspace-card",null,e("span",{slot:"title"},"Upcoming Events"),e("em",null,"Events list + map coming...")),e("workspace-card",null,e("span",{slot:"title"},"Collaborations"),e("hub-collaborations",null)),e("workspace-card",null,e("span",{slot:"title"},"Channels"),e("hub-discussions-channels",null)),e("workspace-card",null,e("span",{slot:"title"},"Hub Changelog"),e("hub-changelog",null)),e("workspace-card",null,e("span",{slot:"title"},"Hub Status"),e("hub-status",null)))}};_r.style=Ir;const qr=":host{display:block;width:auto;height:300px;border:1px solid rgb(161, 161, 161);position:relative;overflow:auto}.title{font-weight:600;width:100%;display:block;border-bottom:1px solid #888;background-color:#f0f0f0;padding:0.5rem;height:20px;position:sticky;top:0px;z-index:100}.tab{line-height:3em;display:none;cursor:pointer}:host(:hover) .tab{display:block;position:absolute;cursor:pointer;top:-10px;border:1px solid #AAA;background-color:#DDD}";const Cr=class{constructor(e){t(this,e)}render(){return e(n,null,e("div",{class:"tab"},this.renderTab()),e("div",{class:"tab-content"},e("span",{class:"title"},e("slot",{name:"title"})),e("span",{class:"body"},e("slot",null))))}renderTab(){return e("calcite-list",null,e("calcite-list-item",{label:"Card",description:""},e("calcite-action",{icon:"drag",label:"drag",scale:"s",slot:"actions-start"}),e("calcite-action",{icon:"pencil",label:"edit",slot:"actions-end"}),e("calcite-action",{icon:"x",label:"delete",slot:"actions-end"}),e("calcite-action",{icon:"ellipsis",label:"menu",slot:"actions-end"})))}};Cr.style=qr;const Mr=":host{display:block}#title{color:white;font-size:500;padding:auto 0}#profile{float:right}";const Ur=class{constructor(e){t(this,e)}signinClick(){const t=new CustomEvent("arcgisAppIdentityStartSignIn");document.dispatchEvent(t)}signoutClick(){const t=new CustomEvent("arcgisAppIdentityStartSignOut");document.dispatchEvent(t)}signedinEvent(t){v.context=t.detail}signedoutEvent(t){v.context=null}render(){return e(n,null,e("slot",null),e("span",{id:"title"},"ArcGIS Hub"),e("span",{id:"profile"},e("arcgis-app-identity",{"client-id":v.app.client,"redirect-uri":v.app.redirect,portal:v.app.portal}),this.renderIdentity()))}renderIdentity(){var t;if(!!v.user){return e("calcite-dropdown",null,e("calcite-button",{slot:"dropdown-trigger"},(t=v.user)===null||t===void 0?void 0:t.fullName),e("calcite-dropdown-group",null,e("calcite-dropdown-item",{onclick:this.signoutClick},"Sign Out")))}else{return e("calcite-button",{ref:t=>this.signinButton=t,onclick:this.signinClick},"Sign In")}}};Ur.style=Mr;export{s as hub_activity_stats,c as hub_changelog,br as hub_collaborations,wr as hub_discussions_channels,Dr as hub_discussions_moderation,xr as hub_discussions_post_editor,$r as hub_feed,Tr as hub_status,Nr as hub_text,_r as hub_user_workspace,Cr as workspace_card,Ur as workspace_navigation};
//# sourceMappingURL=p-5d34a1b9.entry.js.map
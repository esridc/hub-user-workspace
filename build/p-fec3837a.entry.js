import{r as t,h as e,H as n,g as r,f as i}from"./p-384e1fb1.js";const s=":host{display:block}";const o=class{constructor(e){t(this,e)}render(){return e(n,null,e("slot",null),e("arcgis-stat-card",{"value-color":"","card-title":"Pageviews","title-tooltip":"Every visit to this item's page.",subtitle:"Last 30 Days",value:"1,042","text-align":"end","trailing-text":"",unit:"","unit-position":"after",corners:"squared",shareable:"true","shareable-by-value":"false","shareable-on-hover":"true"},e("calcite-icon",{icon:"arrow-bold-up",slot:"value-media"}),e("div",{slot:"footer"},e("svg",{width:"100%",viewBox:"0 0 440 120",class:"chart"},e("polyline",{fill:"none",stroke:"#0074d9","stroke-width":"2",points:"00,120 20,60 40,80 60,20 80,80 100,80 120,60 140,100 160,90 180,80 200, 110 220, 10 240, 70 260, 100 280, 100 300, 40 320, 0 340, 100 360, 100 380, 120 400, 60 420, 70 440, 80"})))))}};o.style=s;const a=[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"week",seconds:604800},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60},{label:"second",seconds:1}];const c=t=>{const e=Math.floor(((new Date).valueOf()-new Date(t).valueOf())/1e3);const{interval:n,unit:r}=u(e);const i=n===1?"":"s";return`${n} ${r}${i} ago`};const u=t=>{for(let{label:e,seconds:n}of a){const r=Math.floor(t/n);if(r>=1){return{interval:r,unit:e}}}return{interval:0,unit:""}};const l=":host{display:block}";const d=class{constructor(e){t(this,e);this.changeTypes={add:{icon:"plus"},change:{icon:"fork-right"},fix:{icon:"debug"}};this.releases=[]}componentWillLoad(){this.getChangelog()}async getChangelog(){const t=await fetch("./data/changelog.json");const e=await t.json();this.releases=e.releases}formatDate(t){return new Date(t).toLocaleDateString("en-us",{weekday:"long",year:"numeric",month:"short",day:"numeric"})}render(){return e(n,null,e("slot",null),e("calcite-accordion",{scale:"m",appearance:"solid","selection-mode":"multiple"},this.releases.map((t=>e("calcite-accordion-item",{heading:this.formatDate(t.timestamp),description:`${t.changes.length} changes ${c(t.timestamp)}`,"icon-start":"","icon-end":""},e("calcite-list",{id:"changes"},t.changes.map((t=>e("calcite-list-item",{description:t.description},e("calcite-chip",{class:"list-chip",icon:this.changeTypes[t.type].icon,scale:"s",appearance:"solid",kind:"neutral",slot:"content-start"},t.type))))))))))}};d.style=l;const p=(t,e,n)=>{const r=t.get(e);if(!r){t.set(e,[n])}else if(!r.includes(n)){r.push(n)}};const f=(t,e)=>{let n;return(...r)=>{if(n){clearTimeout(n)}n=setTimeout((()=>{n=0;t(...r)}),e)}};const h=t=>!("isConnected"in t)||t.isConnected;const m=f((t=>{for(let e of t.keys()){t.set(e,t.get(e).filter(h))}}),2e3);const g=()=>{if(typeof r!=="function"){return{}}const t=new Map;return{dispose:()=>t.clear(),get:e=>{const n=r();if(n){p(t,e,n)}},set:e=>{const n=t.get(e);if(n){t.set(e,n.filter(i))}m(t)},reset:()=>{t.forEach((t=>t.forEach(i)));m(t)}}};const b=t=>typeof t==="function"?t():t;const w=(t,e=((t,e)=>t!==e))=>{const n=b(t);let r=new Map(Object.entries(n!==null&&n!==void 0?n:{}));const i={dispose:[],get:[],set:[],reset:[]};const s=()=>{var e;r=new Map(Object.entries((e=b(t))!==null&&e!==void 0?e:{}));i.reset.forEach((t=>t()))};const o=()=>{i.dispose.forEach((t=>t()));s()};const a=t=>{i.get.forEach((e=>e(t)));return r.get(t)};const c=(t,n)=>{const s=r.get(t);if(e(n,s,t)){r.set(t,n);i.set.forEach((e=>e(t,n,s)))}};const u=typeof Proxy==="undefined"?{}:new Proxy(n,{get(t,e){return a(e)},ownKeys(t){return Array.from(r.keys())},getOwnPropertyDescriptor(){return{enumerable:true,configurable:true}},has(t,e){return r.has(e)},set(t,e,n){c(e,n);return true}});const l=(t,e)=>{i[t].push(e);return()=>{y(i[t],e)}};const d=(e,n)=>{const r=l("set",((t,r)=>{if(t===e){n(r)}}));const i=l("reset",(()=>n(b(t)[e])));return()=>{r();i()}};const p=(...t)=>{const e=t.reduce(((t,e)=>{if(e.set){t.push(l("set",e.set))}if(e.get){t.push(l("get",e.get))}if(e.reset){t.push(l("reset",e.reset))}if(e.dispose){t.push(l("dispose",e.dispose))}return t}),[]);return()=>e.forEach((t=>t()))};const f=t=>{const e=r.get(t);i.set.forEach((n=>n(t,e,e)))};return{state:u,get:a,set:c,on:l,onChange:d,use:p,dispose:o,reset:s,forceUpdate:f}};const y=(t,e)=>{const n=t.indexOf(e);if(n>=0){t[n]=t[t.length-1];t.length--}};const v=(t,e)=>{const n=w(t,e);n.use(g());return n};const{state:O,onChange:k}=v({user:null,context:null,app:null});k("user",(t=>{O.user=t}));k("context",(t=>{O.context=t;O.user=t===null||t===void 0?void 0:t._currentUser}));function S(t){return Object.keys(t).some((e=>{let n=t[e];if(!n){return false}if(n&&n.toParam){n=n.toParam()}const r=n.constructor.name;switch(r){case"Array":return false;case"Object":return false;case"Date":return false;case"Function":return false;case"Boolean":return false;case"String":return false;case"Number":return false;default:return true}}))}function $(t){const e={};Object.keys(t).forEach((n=>{var r,i;let s=t[n];if(s&&s.toParam){s=s.toParam()}if(!s&&s!==0&&typeof s!=="boolean"&&typeof s!=="string"){return}const o=s.constructor.name;let a;switch(o){case"Array":const t=(i=(r=s[0])===null||r===void 0?void 0:r.constructor)===null||i===void 0?void 0:i.name;a=t==="Array"?s:t==="Object"?JSON.stringify(s):s.join(",");break;case"Object":a=JSON.stringify(s);break;case"Date":a=s.valueOf();break;case"Function":a=null;break;case"Boolean":a=s+"";break;default:a=s;break}if(a||a===0||typeof a==="string"||Array.isArray(a)){e[n]=a}}));return e}function D(t,e){if(Array.isArray(e)&&e[0]&&Array.isArray(e[0])){return e.map((e=>D(t,e))).join("&")}return encodeURIComponent(t)+"="+encodeURIComponent(e)}function j(t){const e=$(t);return Object.keys(e).map((t=>D(t,e[t]))).join("&")}var E={FormData:globalThis.FormData,File:globalThis.File,Blob:globalThis.Blob};function A(t,e){const n=S(t)||e;const r=$(t);if(n){const t=new E.FormData;Object.keys(r).forEach((e=>{if(typeof Blob!=="undefined"&&r[e]instanceof Blob){const n=r["fileName"]||r[e].name||e;t.append(e,r[e],n)}else{t.append(e,r[e])}}));return t}else{return j(t)}}class x extends Error{constructor(t,e,n,r,i){super(t);const s=new.target.prototype;Object.setPrototypeOf(this,s);t=t||"UNKNOWN_ERROR";e=e||"UNKNOWN_ERROR_CODE";this.name="ArcGISRequestError";this.message=e==="UNKNOWN_ERROR_CODE"?t:`${e}: ${t}`;this.originalMessage=t;this.code=e;this.response=n;this.url=r;this.options=i}}function T(t){if(console&&console.warn){console.warn.apply(console,[t])}}var N=function t(){return Promise.resolve({fetch:globalThis.fetch,Headers:globalThis.Headers,Response:globalThis.Response,Request:globalThis.request})};const R=`@esri/arcgis-rest-js`;function P(){return globalThis.DEFAULT_ARCGIS_REQUEST_OPTIONS||{httpMethod:"POST",params:{f:"json"}}}class C extends x{constructor(t="AUTHENTICATION_ERROR",e="AUTHENTICATION_ERROR_CODE",n,r,i){super(t,e,n,r,i);this.name="ArcGISAuthError";this.message=e==="AUTHENTICATION_ERROR_CODE"?t:`${e}: ${t}`;const s=new.target.prototype;Object.setPrototypeOf(this,s)}retry(t,e=1){let n=0;const r=(i,s)=>{n=n+1;t(this.url,this.options).then((t=>{const e=Object.assign(Object.assign({},this.options),{authentication:t});return _(this.url,e)})).then((t=>{i(t)})).catch((t=>{if(t.name==="ArcGISAuthError"&&n<e){r(i,s)}else if(t.name===this.name&&t.message===this.message&&n>=e){s(this)}else{s(t)}}))};return new Promise(((t,e)=>{r(t,e)}))}}function I(t,e,n,r,i){if(t.code>=400){const{message:n,code:i}=t;throw new x(n,i,t,e,r)}if(t.error){const{message:n,code:s,messageCode:o}=t.error;const a=o||s||"UNKNOWN_ERROR_CODE";if(s===498||s===499){if(i){throw i}else{throw new C(n,a,t,e,r)}}throw new x(n,a,t,e,r)}if(t.status==="failed"||t.status==="failure"){let n;let i="UNKNOWN_ERROR_CODE";try{n=JSON.parse(t.statusMessage).message;i=JSON.parse(t.statusMessage).code}catch(e){n=t.statusMessage||t.message}throw new x(n,i,t,e,r)}return t}function _(t,e){const n=P();const r=Object.assign(Object.assign(Object.assign({httpMethod:"POST"},n),e),{params:Object.assign(Object.assign({},n.params),e.params),headers:Object.assign(Object.assign({},n.headers),e.headers)});const{httpMethod:i,rawResponse:s}=r;const o=Object.assign({f:"json"},r.params);let a=null;const c={method:i,signal:r.signal,credentials:r.credentials||"same-origin"};if(r.headers&&r.headers["X-Esri-Auth-Client-Id"]&&t.indexOf("/oauth2/platformSelf")>-1){c.credentials="include"}let u;if(typeof r.authentication==="string"){const t=r.authentication;u={portal:"https://www.arcgis.com/sharing/rest",getToken:()=>Promise.resolve(t)};if(!r.authentication.startsWith("AAPK")&&!r.suppressWarnings&&!globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING){T(`Using an oAuth 2.0 access token directly in the token option is discouraged. Consider using ArcGISIdentityManager or Application session. See https://esriurl.com/arcgis-rest-js-direct-token-warning for more information.`);globalThis.ARCGIS_REST_JS_SUPPRESS_TOKEN_WARNING=true}}else{u=r.authentication}const l=t;return(u?u.getToken(t).catch((e=>{e.url=t;e.options=r;a=e;return Promise.resolve("")})):Promise.resolve("")).then((e=>{if(e.length){o.token=e}if(u&&u.getDomainCredentials){c.credentials=u.getDomainCredentials(t)}const n={};if(c.method==="GET"){if(o.token&&r.hideToken&&typeof window==="undefined"){n["X-Esri-Authorization"]=`Bearer ${o.token}`;delete o.token}const i=j(o);const s=i===""?t:t+"?"+j(o);if(r.maxUrlLength&&s.length>r.maxUrlLength||o.token&&r.hideToken){c.method="POST";if(e.length&&r.hideToken){o.token=e;delete n["X-Esri-Authorization"]}}else{t=s}}const i=new RegExp("/items/.+/updateResources").test(t);if(c.method==="POST"){c.body=A(o,i)}c.headers=Object.assign(Object.assign({},n),r.headers);if((typeof window==="undefined"||window&&typeof window.document==="undefined")&&!c.headers.referer){c.headers.referer=R}if(!S(o)&&!i){c.headers["Content-Type"]="application/x-www-form-urlencoded"}return globalThis.fetch?globalThis.fetch(t,c):N().then((({fetch:e})=>e(t,c)))})).then((e=>{if(!e.ok){const{status:n,statusText:i}=e;throw new x(i,`HTTP ${n}`,e,t,r)}if(s){return e}switch(o.f){case"json":return e.json();case"geojson":return e.json();case"html":return e.text();case"text":return e.text();default:return e.blob()}})).then((e=>{if((o.f==="json"||o.f==="geojson")&&!s){const n=I(e,l,o,r,a);if(a){const e=t.toLowerCase().split(/\/rest(\/admin)?\/services\//)[0];r.authentication.federatedServers[e]={token:[],expires:new Date(Date.now()+86400*1e3)};a=null}return n}else{return e}}))}function q(t,e={params:{f:"json"}}){return _(t,e).catch((t=>{if(t instanceof C&&e.authentication&&typeof e.authentication!=="string"&&e.authentication.canRefresh&&e.authentication.refreshCredentials){return t.retry((()=>e.authentication.refreshCredentials()),1)}else{return Promise.reject(t)}}))}function M(t,e,n){const r=["params","httpMethod","rawResponse","authentication","portal","fetch","maxUrlLength","headers"];const i=Object.assign(Object.assign({params:{}},n),t);i.params=e.reduce(((e,n)=>{if(t[n]||typeof t[n]==="boolean"||typeof t[n]==="number"&&t[n]===0){e[n]=t[n]}return e}),i.params);return r.reduce(((t,e)=>{if(i[e]){t[e]=i[e]}return t}),{})}function U(t){if(typeof t!=="string"){return t}t=t.trim();if(t[t.length-1]==="/"){t=t.slice(0,-1)}return t}function G(t){const[e,n]=t.split("=");return{key:decodeURIComponent(e),value:decodeURIComponent(n)}}function W(t){if(!t||t.length<=0){return{}}return t.replace(/^#/,"").replace(/^\?/,"").split("&").reduce(((t,e)=>{const{key:n,value:r}=G(e);t[n]=r;return t}),{})}function L(t={}){if(t.portal){return U(t.portal)}if(t.authentication&&typeof t.authentication!=="string"){return t.authentication.portal}return"https://www.arcgis.com/sharing/rest"}const F=/[\x00-\x1F\x7F-\x9F\xA0]/g;function H(t){return t.replace(F,"")}function J(t,e){const n=K(t,e);const r=Object.assign({httpMethod:"GET"},e);return q(n,r)}const K=(t,e)=>{const n=typeof e==="string"?e:L(e);return`${n}/content/items/${t}`};function V(t,e){const n=`${K(t,e)}/data`;const r=Object.assign({httpMethod:"GET",params:{}},e);if(r.file){r.params.f=null}return q(n,r).catch((t=>{const e=RegExp(/The string did not match the expected pattern|(Unexpected end of (JSON input|data at line 1 column 1))/i);if(e.test(t.message)){return}else throw t}))}function B(t,e){const n=`${K(t,e)}/groups`;return q(n,e)}function z(t,e){const{fileName:n="iteminfo.xml",readAs:r="text"}=e||{};const i=Object.assign({httpMethod:"GET"},e);return Y(t,`/info/${n}`,r,i)}function Q(t,e){const n=Object.assign(Object.assign({},e),{fileName:"metadata/metadata.xml"});return z(t,n)}function Y(t,e,n,r){const i=`${K(t,r)}${e}`;const s=Object.assign({params:{}},r);const o=s.rawResponse;s.rawResponse=true;s.params.f=null;return q(i,s).then((t=>{if(o){return t}return n!=="json"?t[n]():t.text().then((t=>JSON.parse(H(t))))}))}function X(t,e){const n=`${L(e)}/community/groups/${t}/userlist`;const r=M(e||{},["name","num","start","sortField","sortOrder","joined","memberType"],{httpMethod:"GET"});return q(n,r)}class Z{constructor(t=""){this.termStack=[];this.rangeStack=[];this.openGroups=0;this.q=t}match(...t){this.termStack=this.termStack.concat(t);return this}in(t){const e=`\`in(${t?`"${t}"`:""})\``;if(!this.hasRange&&!this.hasTerms){T(`${e} was called with no call to \`match(...)\` or \`from(...)\`/\`to(...)\`. Your query was not modified.`);return this}if(t&&t!=="*"){this.q+=`${t}:`}return this.commit()}startGroup(){this.commit();if(this.openGroups>0){this.q+=" "}this.openGroups++;this.q+="(";return this}endGroup(){if(this.openGroups<=0){T(`\`endGroup(...)\` was called without calling \`startGroup(...)\` first. Your query was not modified.`);return this}this.commit();this.openGroups--;this.q+=")";return this}and(){return this.addModifier("and")}or(){return this.addModifier("or")}not(){return this.addModifier("not")}from(t){if(this.hasTerms){T(`\`from(...)\` is not allowed after \`match(...)\` try using \`.from(...).to(...).in(...)\`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01").  Your query was not modified.`);return this}this.rangeStack[0]=t;return this}to(t){if(this.hasTerms){T(`\`to(...)\` is not allowed after \`match(...)\` try using \`.from(...).to(...).in(...)\`. Optionally, you may see this because dates are incorrectly formatted. Dates should be a primative Date value, aka a number in milliseconds or Date object, ie new Date("2020-01-01"). Your query was not modified.`);return this}this.rangeStack[1]=t;return this}boost(t){this.commit();this.q+=`^${t}`;return this}toParam(){this.commit();this.cleanup();return this.q}clone(){this.commit();this.cleanup();return new Z(this.q+"")}addModifier(t){if(this.currentModifer){T(`You have called \`${this.currentModifer}()\` after \`${t}()\`. Your current query was not modified.`);return this}this.commit();if(this.q===""&&t!=="not"){T(`You have called \`${t}()\` without calling another method to modify your query first. Try calling \`match()\` first.`);return this}this.currentModifer=t;this.q+=this.q===""?"":" ";this.q+=`${t.toUpperCase()} `;return this}hasWhiteSpace(t){return/\s/g.test(t)}formatTerm(t){if(t instanceof Date){return t.getTime()}if(typeof t==="string"&&this.hasWhiteSpace(t)){return`"${t}"`}return t}commit(){this.currentModifer=undefined;if(this.hasRange){this.q+=`[${this.formatTerm(this.rangeStack[0])} TO ${this.formatTerm(this.rangeStack[1])}]`;this.rangeStack=[undefined,undefined]}if(this.hasTerms){this.q+=this.termStack.map((t=>this.formatTerm(t))).join(" ");this.termStack=[]}return this}get hasTerms(){return this.termStack.length>0}get hasRange(){return this.rangeStack.length&&this.rangeStack[0]&&this.rangeStack[1]}cleanup(){if(this.openGroups>0){T(`Automatically closing ${this.openGroups} group(s). You can use \`endGroup(...)\` to remove this warning.`);while(this.openGroups>0){this.q+=")";this.openGroups--}}const t=this.q;this.q=t.replace(/( AND ?| NOT ?| OR ?)*$/,"");if(t!==this.q){T(`\`startGroup(...)\` was called without calling \`endGroup(...)\` first. Your query was not modified.`)}this.q=this.q.replace(/(\(\))*/,"")}}function tt(t,e){let n;if(typeof t==="string"||t instanceof Z){n={httpMethod:"GET",params:{q:t}}}else{n=M(t,["q","num","start","sortField","sortOrder","searchUserAccess","searchUserName","filter","countFields","countSize","categories","categoryFilters"],{httpMethod:"GET"})}let r;switch(e){case"item":r="/search";break;case"group":r="/community/groups";break;case"groupContent":if(typeof t!=="string"&&!(t instanceof Z)&&t.groupId){r=`/content/groups/${t.groupId}/search`}else{return Promise.reject(new Error("you must pass a `groupId` option to `searchGroupContent`"))}break;default:r="/portals/self/users/search";break}const i=L(n)+r;return q(i,n).then((n=>{if(n.nextStart&&n.nextStart!==-1){n.nextPage=function(){let r;if(typeof t==="string"||t instanceof Z){r={q:t,start:n.nextStart}}else{r=t;r.start=n.nextStart}return tt(r,e)}}return n}))}function et(t){return tt(t,"item")}function nt(t){return tt(t,"group")}function rt(t){return tt(t,"groupContent")}function it(t){let e;let n={httpMethod:"GET"};if(typeof t==="string"){e=`https://www.arcgis.com/sharing/rest/community/users/${t}`}else{const r=t.username||t.authentication.username;e=`${L(t)}/community/users/${encodeURIComponent(r)}`;n=Object.assign(Object.assign({},t),n)}return q(e,n)}function st(t){let e={httpMethod:"GET"};const n=encodeURIComponent(t.authentication.username);const r=L(t);const i=`${r}/community/users/${n}/notifications`;e=Object.assign(Object.assign({},t),e);return q(i,e)}function ot(t){return tt(t,"user")}function at(t,e){const n=t?t:"self";const r=`${L(e)}/portals/${n}`;const i=Object.assign({httpMethod:"GET"},e);return q(r,i)}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ct=function(){ct=Object.assign||function t(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s))e[s]=n[s]}return e};return ct.apply(this,arguments)};function ut(t,e){var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0)n[r]=t[r];if(t!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++){if(e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i]))n[r[i]]=t[r[i]]}return n}function lt(t,e){return e.split(".").reduce((function(t,e){return t?t[e]:undefined}),t)}function dt(t){let e={};if(Array.isArray(t)){e=t.map(dt)}else if(typeof t==="object"){for(const n in t){if(t.hasOwnProperty(n)){const r=t[n];if(r!=null&&typeof r==="object"){if(r instanceof Date){e[n]=new Date(r.getTime())}else if(typeof Blob!=="undefined"&&r instanceof Blob){e[n]=new Blob([r],{type:r.type})}else{e[n]=dt(r)}}else{e[n]=r}}}}else{e=t}return e}function pt(t="i"){return`${t}${Math.random().toString(36).substr(2,8)}`}function ft(t,e,n){return n.indexOf(t)===e}function ht(t,e,n={}){const r=e.split(".");let i=t;const s=r.length-1;r.forEach(((t,e)=>{if(!i.hasOwnProperty(t)||i[t]==null){if(e===s){i[t]=n}else{i[t]={}}}else if(e===s){if(typeof i[t]==="object"&&!Array.isArray(i[t])){i[t]=Object.assign(i[t],dt(n))}else{i[t]=n}}i=i[t]}))}function mt(t,e,n){const r=lt(t,e);return r!==undefined?r:n}function gt(t,e,n){if(Array.isArray(t)){t=t.join(".")}ht(n,t,e)}class bt extends Error{constructor(t,e,n){e=e||"UNKNOWN_ERROR";n=mt(n,"rootCause",n);super(e);this.operation=t;this.name="OperationError";this.rootCause=n;Object.setPrototypeOf(this,bt.prototype);this.stack=mt(n,"stack",(new Error).stack)}}const wt=t=>e=>t.reduce(((t,n)=>t.then(n).catch((t=>{if(t.name==="OperationError"){return Promise.reject(t)}else{const t=`IPipeableFn did not reject with an OperationError \n Operation Stack: \n ${e.stack.toString()}`;const n=new bt("pipeline execution error",t);n.operationStack=e.stack.serialize();return Promise.reject(n)}}))),Promise.resolve(e));function yt(t,e=[]){return e.map((e=>e[t]))}function vt(t,e){var n=e;n.rawResponse=false;return q(t,n).then((function(t){var e={token:t.access_token,username:t.username,expires:new Date(Date.now()+(t.expires_in*1e3-1e3)),ssl:t.ssl===true};if(t.refresh_token){e.refreshToken=t.refresh_token}return e}))}function Ot(t,e){var n=e;if(typeof window!=="undefined"&&window.location&&window.location.host){n.params.referer=window.location.host}else{n.params.referer=R}return q(t,n)}var kt=/^https?:\/\/(\S+)\.arcgis\.com.+/;function St(t){return kt.test(t)}function $t(t){if(!kt.test(t)){return t}switch(Dt(t)){case"dev":return"https://devext.arcgis.com/sharing/rest";case"qa":return"https://qaext.arcgis.com/sharing/rest";default:return"https://www.arcgis.com/sharing/rest"}}function Dt(t){if(!kt.test(t)){return null}var e=t.match(kt);var n=e[1].split(".").pop();if(n.includes("dev")){return"dev"}if(n.includes("qa")){return"qa"}return"production"}function jt(t,e){var n=U($t(e)).replace(/https?:\/\//,"");var r=U(t).replace(/https?:\/\//,"");return new RegExp(r,"i").test(n)}function Et(t,e){var n=St(t);var r=St(e);var i=Dt(t);var s=Dt(e);if(n&&r&&i===s){return true}return false}function At(t,e,n){if(n===void 0){n="https://www.arcgis.com/sharing/rest"}var r=n+"/oauth2/validateAppAccess";var i={method:"POST",params:{f:"json",client_id:e,token:t}};return q(r,i)}function xt(){var t={promise:null,resolve:null,reject:null};t.promise=new Promise((function(e,n){t.resolve=e;t.reject=n}));return t}var Tt=function(){function t(t){this.clientId=t.clientId;this._refreshToken=t.refreshToken;this._refreshTokenExpires=t.refreshTokenExpires;this.username=t.username;this.password=t.password;this._token=t.token;this._tokenExpires=t.tokenExpires;this.portal=t.portal?U(t.portal):"https://www.arcgis.com/sharing/rest";this.ssl=t.ssl;this.provider=t.provider||"arcgis";this.tokenDuration=t.tokenDuration||20160;this.redirectUri=t.redirectUri;this.refreshTokenTTL=t.refreshTokenTTL||20160;this.server=t.server;this.federatedServers={};this.trustedDomains=[];if(t.server){var e=this.getServerRootUrl(t.server);this.federatedServers[e]={token:t.token,expires:t.tokenExpires}}this._pendingTokenRequests={}}Object.defineProperty(t.prototype,"token",{get:function(){return this._token},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"tokenExpires",{get:function(){return this._tokenExpires},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"refreshToken",{get:function(){return this._refreshToken},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"refreshTokenExpires",{get:function(){return this._refreshTokenExpires},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"trustedServers",{get:function(){console.log("DEPRECATED: use federatedServers instead");return this.federatedServers},enumerable:false,configurable:true});t.beginOAuth2=function(e,n){if(n===void 0){n=window}if(e.duration){console.log("DEPRECATED: 'duration' is deprecated - use 'expiration' instead")}var r=ct({portal:"https://www.arcgis.com/sharing/rest",provider:"arcgis",expiration:20160,popup:true,popupWindowFeatures:"height=400,width=600,menubar=no,location=yes,resizable=yes,scrollbars=yes,status=yes",state:e.clientId,locale:""},e),i=r.portal,s=r.provider,o=r.clientId,a=r.expiration,c=r.redirectUri,u=r.popup,l=r.popupWindowFeatures,d=r.state,p=r.locale,f=r.params;var h;if(s==="arcgis"){h=i+"/oauth2/authorize?client_id="+o+"&response_type=token&expiration="+(e.duration||a)+"&redirect_uri="+encodeURIComponent(c)+"&state="+d+"&locale="+p}else{h=i+"/oauth2/social/authorize?client_id="+o+"&socialLoginProviderName="+s+"&autoAccountCreateForSocial=true&response_type=token&expiration="+(e.duration||a)+"&redirect_uri="+encodeURIComponent(c)+"&state="+d+"&locale="+p}if(f){h=h+"&"+j(f)}if(!u){n.location.href=h;return undefined}var m=xt();n["__ESRI_REST_AUTH_HANDLER_"+o]=function(e,n){if(e){var r=JSON.parse(e);m.reject(new C(r.errorMessage,r.error));return}if(n){var s=JSON.parse(n);m.resolve(new t({clientId:o,portal:i,ssl:s.ssl,token:s.token,tokenExpires:new Date(s.expires),username:s.username}))}};n.open(h,"oauth-window",l);return m.promise};t.completeOAuth2=function(e,n){if(n===void 0){n=window}var r=ct({portal:"https://www.arcgis.com/sharing/rest",popup:true},e),i=r.portal,s=r.clientId,o=r.popup;function a(e,r){try{var a=void 0;var c="__ESRI_REST_AUTH_HANDLER_"+s;if(o){if(n.opener){if(n.opener.parent&&n.opener.parent[c]){a=n.opener.parent[c]}else if(n.opener&&n.opener[c]){a=n.opener[c]}}else{if(n!==n.parent&&n.parent&&n.parent[c]){a=n.parent[c]}}if(a){a(e?JSON.stringify(e):undefined,JSON.stringify(r));n.close();return undefined}}}catch(t){throw new C('Unable to complete authentication. It\'s possible you specified popup based oAuth2 but no handler from "beginOAuth2()" present. This generally happens because the "popup" option differs between "beginOAuth2()" and "completeOAuth2()".')}if(e){throw new C(e.errorMessage,e.error)}return new t({clientId:s,portal:i,ssl:r.ssl,token:r.token,tokenExpires:r.expires,username:r.username})}var c=W(n.location.hash);if(!c.access_token){var u=void 0;var l="Unknown error";if(c.error){u=c.error;l=c.error_description}return a({error:u,errorMessage:l})}var d=c.access_token;var p=new Date(Date.now()+parseInt(c.expires_in,10)*1e3-60*1e3);var f=c.username;var h=c.ssl==="true";return a(undefined,{token:d,expires:p,ssl:h,username:f})};t.fromParent=function(e,n){if(!n&&window){n=window}var r;return new Promise((function(i,s){r=function(e){if(e.source===n.parent&&e.data){try{return i(t.parentMessageHandler(e))}catch(t){return s(t)}}};n.addEventListener("message",r,false);n.parent.postMessage({type:"arcgis:auth:requestCredential"},e)})).then((function(t){n.removeEventListener("message",r,false);return t}))};t.authorize=function(t,e){if(t.duration){console.log("DEPRECATED: 'duration' is deprecated - use 'expiration' instead")}var n=ct({portal:"https://arcgis.com/sharing/rest",expiration:20160},t),r=n.portal,i=n.clientId,s=n.expiration,o=n.redirectUri;e.writeHead(301,{Location:r+"/oauth2/authorize?client_id="+i+"&expiration="+(t.duration||s)+"&response_type=code&redirect_uri="+encodeURIComponent(o)});e.end()};t.exchangeAuthorizationCode=function(e,n){var r=ct({portal:"https://www.arcgis.com/sharing/rest",refreshTokenTTL:20160},e),i=r.portal,s=r.clientId,o=r.redirectUri,a=r.refreshTokenTTL;return vt(i+"/oauth2/token",{params:{grant_type:"authorization_code",client_id:s,redirect_uri:o,code:n}}).then((function(e){return new t({clientId:s,portal:i,ssl:e.ssl,redirectUri:o,refreshToken:e.refreshToken,refreshTokenTTL:a,refreshTokenExpires:new Date(Date.now()+(a-1)*60*1e3),token:e.token,tokenExpires:e.expires,username:e.username})}))};t.deserialize=function(e){var n=JSON.parse(e);return new t({clientId:n.clientId,refreshToken:n.refreshToken,refreshTokenExpires:new Date(n.refreshTokenExpires),username:n.username,password:n.password,token:n.token,tokenExpires:new Date(n.tokenExpires),portal:n.portal,ssl:n.ssl,tokenDuration:n.tokenDuration,redirectUri:n.redirectUri,refreshTokenTTL:n.refreshTokenTTL})};t.fromCredential=function(e){var n=typeof e.ssl!=="undefined"?e.ssl:true;var r=e.expires||Date.now()+72e5;return new t({portal:e.server.includes("sharing/rest")?e.server:e.server+"/sharing/rest",ssl:n,token:e.token,username:e.userId,tokenExpires:new Date(r)})};t.parentMessageHandler=function(e){if(e.data.type==="arcgis:auth:credential"){return t.fromCredential(e.data.credential)}if(e.data.type==="arcgis:auth:error"){var n=new Error(e.data.error.message);n.name=e.data.error.name;throw n}else{throw new Error("Unknown message type.")}};t.prototype.toCredential=function(){return{expires:this.tokenExpires.getTime(),server:this.portal,ssl:this.ssl,token:this.token,userId:this.username}};t.prototype.getUser=function(t){var e=this;if(this._pendingUserRequest){return this._pendingUserRequest}else if(this._user){return Promise.resolve(this._user)}else{var n=this.portal+"/community/self";var r=ct(ct({httpMethod:"GET",authentication:this},t),{rawResponse:false});this._pendingUserRequest=q(n,r).then((function(t){e._user=t;e._pendingUserRequest=null;return t}));return this._pendingUserRequest}};t.prototype.getPortal=function(t){var e=this;if(this._pendingPortalRequest){return this._pendingPortalRequest}else if(this._portalInfo){return Promise.resolve(this._portalInfo)}else{var n=this.portal+"/portals/self";var r=ct(ct({httpMethod:"GET",authentication:this},t),{rawResponse:false});this._pendingPortalRequest=q(n,r).then((function(t){e._portalInfo=t;e._pendingPortalRequest=null;return t}));return this._pendingPortalRequest}};t.prototype.getUsername=function(){if(this.username){return Promise.resolve(this.username)}else if(this._user){return Promise.resolve(this._user.username)}else{return this.getUser().then((function(t){return t.username}))}};t.prototype.getToken=function(t,e){if(Et(this.portal,t)){return this.getFreshToken(e)}else if(new RegExp(this.portal,"i").test(t)){return this.getFreshToken(e)}else{return this.getTokenForServer(t,e)}};t.prototype.validateAppAccess=function(t){return this.getToken(this.portal).then((function(e){return At(e,t)}))};t.prototype.toJSON=function(){return{clientId:this.clientId,refreshToken:this.refreshToken,refreshTokenExpires:this.refreshTokenExpires,username:this.username,password:this.password,token:this.token,tokenExpires:this.tokenExpires,portal:this.portal,ssl:this.ssl,tokenDuration:this.tokenDuration,redirectUri:this.redirectUri,refreshTokenTTL:this.refreshTokenTTL}};t.prototype.serialize=function(){return JSON.stringify(this)};t.prototype.enablePostMessageAuth=function(t,e){if(!e&&window){e=window}this._hostHandler=this.createPostMessageHandler(t);e.addEventListener("message",this._hostHandler,false)};t.prototype.disablePostMessageAuth=function(t){if(!t&&window){t=window}t.removeEventListener("message",this._hostHandler,false)};t.prototype.refreshSession=function(t){this._user=null;if(this.username&&this.password){return this.refreshWithUsernameAndPassword(t)}if(this.clientId&&this.refreshToken){return this.refreshWithRefreshToken()}return Promise.reject(new C("Unable to refresh token."))};t.prototype.getServerRootUrl=function(t){var e=U(t).split(/\/rest(\/admin)?\/services(?:\/|#|\?|$)/)[0];var n=e.match(/(https?:\/\/)(.+)/),r=n[1],i=n[2];var s=i.split("/"),o=s[0],a=s.slice(1);return""+r+o.toLowerCase()+"/"+a.join("/")};t.prototype.getDomainCredentials=function(t){if(!this.trustedDomains||!this.trustedDomains.length){return"same-origin"}return this.trustedDomains.some((function(e){return t.startsWith(e)}))?"include":"same-origin"};t.prototype.createPostMessageHandler=function(t){var e=this;return function(n){var r=t.indexOf(n.origin)>-1;var i=n.data.type==="arcgis:auth:requestCredential";var s=e.tokenExpires.getTime()>Date.now();if(r&&i){var o={};if(s){var a=e.toCredential();a.server=a.server.replace("/sharing/rest","");o={type:"arcgis:auth:credential",credential:a}}else{o={type:"arcgis:auth:error",error:{name:"tokenExpiredError",message:"Session token was expired, and not returned to the child application"}}}n.source.postMessage(o,n.origin)}}};t.prototype.getTokenForServer=function(t,e){var n=this;var r=this.getServerRootUrl(t);var i=this.federatedServers[r];if(i&&i.expires&&i.expires.getTime()>Date.now()){return Promise.resolve(i.token)}if(this._pendingTokenRequests[r]){return this._pendingTokenRequests[r]}this._pendingTokenRequests[r]=this.fetchAuthorizedDomains().then((function(){return q(r+"/rest/info",{credentials:n.getDomainCredentials(t)}).then((function(i){if(i.owningSystemUrl){if(!jt(i.owningSystemUrl,n.portal)){throw new C(t+" is not federated with "+n.portal+".","NOT_FEDERATED")}else{return q(i.owningSystemUrl+"/sharing/rest/info",e)}}else if(i.authInfo&&n.federatedServers[r]!==undefined){return Promise.resolve({authInfo:i.authInfo})}else{throw new C(t+" is not federated with any portal and is not explicitly trusted.","NOT_FEDERATED")}})).then((function(t){return t.authInfo.tokenServicesUrl})).then((function(e){if(n.token&&n.tokenExpires.getTime()>Date.now()){return Ot(e,{params:{token:n.token,serverUrl:t,expiration:n.tokenDuration,client:"referer"}})}else{return Ot(e,{params:{username:n.username,password:n.password,expiration:n.tokenDuration,client:"referer"}}).then((function(t){n._token=t.token;n._tokenExpires=new Date(t.expires);return t}))}})).then((function(t){n.federatedServers[r]={expires:new Date(t.expires),token:t.token};delete n._pendingTokenRequests[r];return t.token}))}));return this._pendingTokenRequests[r]};t.prototype.getFreshToken=function(t){var e=this;if(this.token&&!this.tokenExpires){return Promise.resolve(this.token)}if(this.token&&this.tokenExpires&&this.tokenExpires.getTime()>Date.now()){return Promise.resolve(this.token)}if(!this._pendingTokenRequests[this.portal]){this._pendingTokenRequests[this.portal]=this.refreshSession(t).then((function(t){e._pendingTokenRequests[e.portal]=null;return t.token}))}return this._pendingTokenRequests[this.portal]};t.prototype.refreshWithUsernameAndPassword=function(t){var e=this;var n=ct({params:{username:this.username,password:this.password,expiration:this.tokenDuration}},t);return Ot(this.portal+"/generateToken",n).then((function(t){e._token=t.token;e._tokenExpires=new Date(t.expires);return e}))};t.prototype.refreshWithRefreshToken=function(t){var e=this;if(this.refreshToken&&this.refreshTokenExpires&&this.refreshTokenExpires.getTime()<Date.now()){return this.refreshRefreshToken(t)}var n=ct({params:{client_id:this.clientId,refresh_token:this.refreshToken,grant_type:"refresh_token"}},t);return vt(this.portal+"/oauth2/token",n).then((function(t){e._token=t.token;e._tokenExpires=t.expires;return e}))};t.prototype.refreshRefreshToken=function(t){var e=this;var n=ct({params:{client_id:this.clientId,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,grant_type:"exchange_refresh_token"}},t);return vt(this.portal+"/oauth2/token",n).then((function(t){e._token=t.token;e._tokenExpires=t.expires;e._refreshToken=t.refreshToken;e._refreshTokenExpires=new Date(Date.now()+(e.refreshTokenTTL-1)*60*1e3);return e}))};t.prototype.fetchAuthorizedDomains=function(){var t=this;if(this.server||!this.portal){return Promise.resolve(this)}return this.getPortal().then((function(e){if(e.authorizedCrossOriginDomains&&e.authorizedCrossOriginDomains.length){t.trustedDomains=e.authorizedCrossOriginDomains.filter((function(t){return!t.startsWith("http://")})).map((function(t){if(t.startsWith("https://")){return t}else{return"https://"+t}}))}return t}))};return t}();function Nt(t){const{host:e,path:n,query:r}=t;const i=e.endsWith("/")?e:`${e}/`;const s=new URL(n,i);s.search=Rt(r);return s.toString()}function Rt(t={}){const e=Object.keys(t).filter((e=>t[e]!==undefined)).reduce(((e,n)=>{e[n]=t[n];return e}),{});return new URLSearchParams(e).toString()}function Pt(t){if(typeof t==="string"){return t.replace(/\/sharing\/rest\/?$/,"")}if(typeof t==="object"){const e=t.portalSelf;const n=e||t;const{portalHostname:r,urlKey:i,customBaseUrl:s}=n;if(r||i&&s){if(n.isPortal){return`https://${n.portalHostname}`}else{return`https://${n.urlKey}.${n.customBaseUrl}`}}}return Pt(L(t))}function Ct(t){return`${Pt(t)}/sharing/rest`}function It(t,e){const n=Pt(e);return`${n}/home/item.html?id=${t}`}const _t=(t,e,n)=>{const{id:r,access:i}=t;const s=`${Ct(e)}/content/items/${r}`;const o=new URLSearchParams({f:"json"});if(i!=="public"&&n){o.append("token",n)}return`${s}?${o.toString()}`};function qt(t){let e=t;if(t.match(/(qaext|\.mapsqa)\.arcgis.com/)){e="https://qaext.arcgis.com"}else if(t.match(/(devext|\.mapsdevext)\.arcgis.com/)){e="https://devext.arcgis.com"}else{if(t.match(/(www|\.maps)\.arcgis.com/)){e="https://www.arcgis.com"}}return e}function Mt(t,e){const n=Pt(e);return`${n}/home/group.html?id=${t}`}function Ut(t,e){const n=Pt(e);return`${n}/home/user.html?user=${t}`}const Gt=["Application","City Engine Web Scene","CityEngine Web Scene","Dashboard","Insights Page","Insights Workbook","Operation View","Web Mapping Application","StoryMap","Web Experience","Urban Model"];const Wt=["CSV Collection","CSV","Feature Collection Template","Feature Collection","Feature Layer","Feature Service","File Geodatabase","GeoJSON","GeoJson","KML Collection","KML","Microsoft Excel","Raster Layer","Shapefile","Stream Service","Table"];const Lt=["CAD Drawing","Document Link","Hub Page","Site Page","Image","iWork Keynote","iWork Numbers","iWork Pages","Microsoft Powerpoint","Microsoft Visio","Microsoft Word","Notebook","PDF","Pro Map","Report Template"];const Ft=["Hub Event"];const Ht=["Form","Quick Capture Project"];const Jt=["Hub Initiative"];const Kt=["Solution"];const Vt=["Hub Initiative Template"];const Bt=["Image Collection","Image Service","Map Service Layer","Map Service","Scene Service","Scene Layer","Vector Tile Service","Web Map Service","Web Map Tile Service","Web Map","Web Scene","WFS","WMS","WMTS"];const zt=["360 VR Experience","AppBuilder Widget Package","Application Configuration","ArcPad Package","Code Attachment","Code Sample","Desktop Add In","Desktop Application Template","Desktop Application","Desktop Style","Explorer Add In","Explorer Layer","Geocoding Service","Geometry Service","Geoprocessing Package","Geoprocessing Sample","Geoprocessing Service","Layer File","Layer Package","Layer Template","Layer","Layout","Locator Package","Map Area","Map Document","Map Package","Map Service Definition","Map Template","Mobile Application","Mobile Map Package","Native Application","Network Analysis Service","Operations Dashboard Add In","Project Package","Project Template","Raster Function Template","Rule Package","Scene Package","Service Definition","SQLite Geodatabase","Style","Tile Package","Vector Tile Package","Workflow Manager Package"];const Qt=["Hub Site Application","Site Application"];const Yt=t=>{if(!t){return}const e=t.toLocaleLowerCase();return Object.keys(Xt).find((t=>{const n=Xt[t];return n.some((t=>t.toLocaleLowerCase()===e))}))};const Xt={app:Gt,dataset:Wt,document:Lt,event:Ft,feedback:Ht,initiative:Jt,template:Vt,solution:Kt,map:Bt,other:zt,site:Qt};function Zt(t){var e=M(t,["where","objectIds","relationParam","time","distance","units","outFields","geometry","geometryType","spatialRel","returnGeometry","maxAllowableOffset","geometryPrecision","inSR","outSR","gdbVersion","returnDistinctValues","returnIdsOnly","returnCountOnly","returnExtentOnly","orderByFields","groupByFieldsForStatistics","outStatistics","returnZ","returnM","multipatchOption","resultOffset","resultRecordCount","quantizationParameters","returnCentroid","resultType","historicMoment","returnTrueCurves","sqlFormat","returnExceededLimitFeatures","f"],{httpMethod:"GET",params:ct({where:"1=1",outFields:"*"},t.params)});return q(U(t.url)+"/query",e)}var te=new RegExp(/.+(?:map|feature|image)server/i);function ee(t){var e=t.match(te);if(e){return e[0]}else{return ne(t)}}function ne(t){var e=t.split("?")[0];return U(e)}function re(t){var e=t.url,n=ut(t,["url"]);var r=ee(e)+"/layers";return q(r,n)}function ie(t){return q(U(t.url),t)}var se=function(t,e,n){if(n===void 0)n=undefined;return e.split(".").reduce((function(t,e){return t?t[e]:n}),t)};function oe(t,e){var n=Object.keys(t);var r=n.reduce((function(n,r){n[r]=e(t[r],r,t);return n}),{});return r}var ae=function(t){return t instanceof Date};var ce=function(t){return typeof t==="function"};var ue=function(t){return typeof t==="object"};var le=function(t){return t instanceof RegExp};function de(t,e,n){n=n||"";if(Array.isArray(t)){return t.map(i)}else if(t&&ue(t)&&!ae(t)&&!le(t)&&!ce(t)){return Object.assign({},t,oe(t,i))}else{var r=e(t,n);return r}function i(t,r){var i=n?n+"."+r:r;return de(t,e,i)}}var pe=function(t){return typeof t==="object"};function fe(t,e){if(Array.isArray(t)){var n=t.map(r).filter((function(t){return t!==null&&t!==undefined}));return he(n)}if(t&&pe(t)){return me(oe(t,r))}else{return ge(t)}function r(t,e){return fe(t)}}function he(t){var e=t;var n=t.reduce((function(t,e){if(ve(e)&&ye(e)){var n=we(e);if(n>t){t=n}}return t}),-1);if(n>-1){if(n===0){e=[]}else{e="{{delete:"+(n-1)+"}}"}}return e}function me(t){var e={obj:{},maxLevel:-1};var n;var r=Object.keys(t).reduce((function(e,n){var r=t[n];if(ve(r)&&ye(r)){var i=we(r);if(i>e.maxLevel){e.maxLevel=i}}else{e.obj[n]=r}return e}),e);if(r.maxLevel>0){if(r.maxLevel===1){n=undefined}else{n="{{delete:"+(r.maxLevel-1)+"}}"}}else{n=r.obj}return n}function ge(t){var e=t;if(typeof t==="string"){if(ye(t)){e=be(t)}}return e}function be(t){var e=t;var n=we(t);if(n===0){e=undefined}else{e="{{delete:"+n+"}}"}return e}var we=function(t){return parseInt(t.replace(/{|}/g,"").split(":")[1])};function ye(t){if(t&&typeof t==="string"){return t.indexOf("{{delete")>-1}else{return false}}var ve=function(t){return typeof t==="string"};function Oe(t,e,n,r){if(r===void 0)r=0;var i=e;if(!e){i="{{delete:"+r+"}}"}return i}var ke=function(t){var e={};if(Array.isArray(t)){e=t.map(ke)}else if(typeof t==="object"){for(var n in t){if(t[n]!=null&&typeof t[n]==="object"){e[n]=ke(t[n])}else{e[n]=t[n]}}}else{e=t}return e};var Se=/{{\s*?[\w].*?}}/g;var $e=function(t){return typeof t==="string"};function De(t,e,n){var r;var i=t.split(":");if(i.length>1){var s=i[0];var o=i[1];var a;if(i[2]){a=i[2]}if(n&&n[o]&&typeof n[o]==="function"){r=se(e,s);r=n[o](s,r,e,a)}else{throw new Error("Attempted to apply non-existant transform "+o+" on "+s+" with params "+t)}}else{r=se(e,t)}return r}function je(t,e){var n=t.split(":")[0];var r=se(e,n,null);if(r!==null&&r!==undefined){return true}else{return false}}function Ee(t){return t||t===""||t===0}function Ae(t,e,n){if(n===void 0)n=null;n=ke(n)||{};if(n.optional){throw new Error("Please do not pass in an `optional` transform; adlib provides that internally.")}else{n.optional=Oe}var r=de(t,(function(t,r){if(!$e(t)){return t}var i;var s=t.match(Se);if(s&&s.length){var o=s.map((function(t){var r=false;var i=t.replace(/{|}/g,"").trim();if(i.indexOf("||")>-1){var s=i.split("||").map((function(t){return t.trim()}));var o=s.length;i=s.find((function(t,n){var i=je(t,e);if(!i){if(n+1===o){r=true;if(!isNaN(t)){t=parseInt(t)}return t}else{return false}}else{return t}}))}var a={key:t,value:i};if(!r){var c=De(i,e,n);a.value=Ee(c)?c:t}return a}));o.forEach((function(e){if(t===e.key){if(typeof e.value==="string"){if(!isNaN(e.value)&&e.value!==""){if(e.value.indexOf(".")>-1){e.value=parseFloat(e.value)}else{if(e.value[0]!=="0"){e.value=parseInt(e.value)}}}}i=e.value}else{t=t.replace(e.key,e.value)}}));if(Ee(i)){return i}else{return t}}else{return t}}));return fe(r)}class xe extends bt{constructor(t,e,n){e=e||"UNKNOWN_ERROR";n=mt(n,"rootCause",n);super(t,e,n);this.name="HubError";this.stack=mt(n,"stack",(new Error).stack)}}function Te(t,e,n){if(!t||!t.thumbnail){return null}let{token:r,width:i}=n||{};if(!r&&typeof n==="string"){r=n}const s=_t(t,e,r);const[o,a]=s.split("?");const c=new URLSearchParams(a);c.delete("f");if(i){c.append("w",i+"")}const u=c.toString();const l=`${o}/info/${t.thumbnail}`;return u?`${l}?${u}`:l}function Ne(t){const e=t.split(" AS ");const n=e[0];const r=e[1]||n.split(".").reverse()[0];const i=n.split(".")[0];const s={enrichment:i,path:n,prop:r};return s}class Re{constructor(){this.operations=[]}startOperation(t){const e=dt(t);e.startedAt=(new Date).getTime();e.state="working";this.operations.push(e)}start(t,e){const n={type:t,id:mt(e,"id",pt(`${t}_`)),inputs:mt(e,"inputs",{}),cleanup:mt(e,"cleanup","n/a"),startedAt:(new Date).getTime(),state:"working"};this.operations.push(n);return n.id}getOperation(t){return this.operations.find((e=>e.id===t))}getOperations(){return this.operations}finish(t,e){const n=this.getOperation(t);if(n){n.duration=(new Date).getTime()-n.startedAt;n.state="completed";if(e){n.output=dt(e)}}else{throw new Error(`No operation with id ${t} present in stack`)}}merge(t){this.operations=[...this.operations,...t.operations]}getCompleted(){return dt(this.operations.filter((t=>t.state==="completed")))}getWorking(){return dt(this.operations.filter((t=>t.state==="working")))}toString(){const t=this.operations.sort(((t,e)=>{if(t.startedAt<e.startedAt){return-1}if(e.startedAt<t.startedAt){return 1}return 0}));return t.map(Pe).join("\n")}serialize(){return{operations:dt(this.getOperations())}}}function Pe(t){let e=`${t.startedAt} : Operation ${t.id} started with inputs ${JSON.stringify(t.inputs)} but was not completed`;if(t.state==="completed"){e=`${t.startedAt} : Operation ${t.id} took ${t.duration} ms with inputs ${JSON.stringify(t.inputs)} and output ${t.output?JSON.stringify(t.output):"n/a"}`}return e}function Ce(t,e){const n=lt(e,"portal")||lt(e,"authentication.portal")||"www.arcgis.com";const r=`${qt(n)}/sharing/rest`;return at(t,Object.assign(Object.assign({},e),{portal:r}))}async function Ie(t){const{parse:e}=await import("./p-d54d09a0.js").then((function(t){return t.p}));const n={ignoreAttributes:false,attributeNamePrefix:"@_",textNodeName:"#value"};return e(t,n)}async function _e(t,e){try{const n=await Q(t,e);return await Ie(n)}catch(t){return null}}const qe=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichGroupIds");return B(e.item.id,r).then((t=>{const{admin:s,member:o,other:a}=t;const c=[...s,...o,...a].map((t=>t.id));n.finish(i);return{data:Object.assign(Object.assign({},e),{groupIds:c}),stack:n,requestOptions:r}})).catch((e=>He(e,t,i)))};const Me=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichMetadata");return _e(e.item.id,r).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{metadata:t}),stack:n,requestOptions:r}}))};const Ue=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichOwner");const s=Object.assign({username:e.item.owner},r);return it(s).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{ownerUser:t}),stack:n,requestOptions:r}})).catch((e=>He(e,t,i)))};const Ge=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichOrg");const s=rn(e.item,e.ownerUser);const o=s?Ce(s,r):Promise.resolve(undefined);return o.then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{org:t}),stack:n,requestOptions:r}})).catch((e=>He(e,t,i)))};const We=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichData");return V(e.item.id,r).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{data:t}),stack:n,requestOptions:r}})).catch((e=>He(e,t,i)))};const Le=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichServer");const s=ee(e.item.url);const o=Object.assign(Object.assign({},r),{url:s});return ie(o).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{server:t}),stack:n,requestOptions:r}})).catch((e=>He(e,t,i)))};const Fe=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichLayers");const s=e.item.url;const o=Object.assign(Object.assign({},r),{url:s});return re(o).then((t=>{const e=[...t.layers,...t.tables];return e.filter((t=>t.type!=="Group Layer"))})).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{layers:t}),stack:n,requestOptions:r}})).catch((e=>He(e,t,i)))};const He=(t,e,n)=>{const{data:r,stack:i,requestOptions:s}=e;i.finish(n,{error:t});return{data:Object.assign(Object.assign({},r),{errors:Ke(t,r.errors)}),stack:i,requestOptions:s}};const Je={groupIds:qe,metadata:Me,ownerUser:Ue,org:Ge,data:We,server:Le,layers:Fe};const Ke=(t,e=[])=>{const n=typeof t==="string"?t:t.message;return[...e,{type:"Other",message:n}]};const Ve=(t,e,n)=>{const r=e.reduce(((t,e)=>{const n=Je[e];n&&t.push(n);return t}),[]);const i=wt(r);return i({data:{item:t},stack:new Re,requestOptions:n}).then((t=>t.data))};function Be(t){const e={other:"content",solution:"template"};return e[t]||t}function ze(t){let e;switch(t.toLowerCase()){case"image service":e="dataset";break;case"feature service":case"raster layer":e="map";break;case"microsoft excel":e="document";break;case"cad drawing":case"feature collection template":case"report template":e="content";break;case"hub project":e="project";break;default:e=Be(Yt(t))}return e}async function Qe(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,typeKeywords:t.typeKeywords,tags:t.tags,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ze(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(ft);const s=e.map(Ne);const o=yt("enrichment",s).filter(ft);let a={};if(o.length){a=await Ve(t,o,n)}s.forEach((t=>{r[t.prop]=lt(a,t.path)}));r.links.thumbnail=Te(t,n);r.links.self=It(r.id,n);r.links.siteRelative=Xe(r.type,r.id,t.typeKeywords);return r}async function Ye(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,typeKeywords:t.typeKeywords,tags:t.tags,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ze(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(ft);const s=e.map(Ne);const o=yt("enrichment",s).filter(ft);let a={};if(o.length){a=await Ve(t,o,n)}s.forEach((t=>{r[t.prop]=lt(a,t.path)}));r.links.thumbnail=Te(t,n);r.links.self=t.url;r.links.siteRelative=Xe(r.type,r.id,t.typeKeywords);return r}const Xe=(t,e,n)=>{let r=tn(t,e,n)||en(t,e,n);if(!r){const i=ze(t);const s=["app","dataset","document","map","template","project"];let o="/content";if(i==="feedback"){o="/feedback/surveys"}else if(Ze(t,n)){o="/pages"}else if(s.indexOf(i)>-1){o=`/${i}s`}r=`${o}/${e}`}return r};const Ze=(t,e=[])=>["Hub Page","Site Page"].includes(t)||e.includes("hubPage");const tn=(t,e,n)=>{let r;if(t==="Solution"){if((n===null||n===void 0?void 0:n.indexOf("Deployed"))>-1){r=`/content/${e}/about`}else{r=`/templates/${e}/about`}}else if(t==="Web Mapping Application"&&(n===null||n===void 0?void 0:n.indexOf("hubSolutionTemplate"))>-1){r=`/templates/${e}/about`}return r};const en=(t,e,n)=>{if(t==="Hub Initiative"&&(n===null||n===void 0?void 0:n.indexOf("hubInitiativeTemplate"))>-1||t==="Hub Initiative Template"){return`/initiatives/templates/${e}/about`}};var nn;(function(t){t["Year"]="year";t["Month"]="month";t["Day"]="day";t["Time"]="time"})(nn||(nn={}));const rn=(t,e)=>t.orgId||(e===null||e===void 0?void 0:e.orgId);class sn extends Error{constructor(t,e,n){super(t);this.status=n;this.url=e}}async function on(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,tags:t.tags,typeKeywords:t.typeKeywords,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ze(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(ft);const s=e.map(Ne);const o=yt("enrichment",s).filter(ft);let a={};if(o.length){a=await Ve(t,o,n)}s.forEach((t=>{r[t.prop]=lt(a,t.path)}));r.links.thumbnail=Te(t,n);r.links.self=It(r.id,n);r.links.siteRelative=Xe(r.type,r.id,t.typeKeywords);return r}const an=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichGroupContentCount");const s=Object.assign({groupId:e.group.id,num:1},r);return rt(s).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{contentCount:t.total}),stack:n,requestOptions:r}})).catch((e=>un(e,t,i)))};const cn=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichGroupContentCount");const s=Object.assign({num:3},r);return X(e.group.id,s).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{membershipSummary:{total:t.total,users:t.users}}),stack:n,requestOptions:r}})).catch((e=>un(e,t,i)))};const un=(t,e,n)=>{const{data:r,stack:i,requestOptions:s}=e;i.finish(n,{error:t});return{data:Object.assign(Object.assign({},r),{errors:Ke(t,r.errors)}),stack:i,requestOptions:s}};const ln={membershipSummary:cn,contentCount:an};function dn(t,e,n){const r=e.reduce(((t,e)=>{const n=ln[e];n&&t.push(n);return t}),[]);const i=wt(r);return i({data:{group:t},stack:new Re,requestOptions:n}).then((t=>t.data))}const pn={arcgis:{label:"ArcGIS Online",url:"https://www.arcgis.com",type:"arcgis"},arcgisQA:{label:"ArcGIS Online QAEXT",url:"https://qaext.arcgis.com",type:"arcgis"},arcgisDEV:{label:"ArcGIS Online DEVEXT",url:"https://devext.arcgis.com",type:"arcgis"},hub:{label:"ArcGIS Hub",url:"https://hub.arcgis.com/api",type:"arcgis-hub"},hubDEV:{label:"ArcGIS Hub DEV",url:"https://hubdev.arcgis.com/api",type:"arcgis-hub"},hubQA:{label:"ArcGIS Hub QA",url:"https://hubqa.arcgis.com/api",type:"arcgis-hub"}};function fn(t){if(typeof t==="string"&&t in pn){return pn[t]}else{return t}}function hn(t){let e={};if(Array.isArray(t)){e={any:t}}else{if(typeof t==="string"){e={any:[t]}}if(typeof t==="object"){e=t}}return e}function mn(t){const e={min:1e3*60,hours:1e3*60*60,days:1e3*60*60*24,weeks:1e3*60*60*24*7};const n=new Date;const r={type:"date-range",from:n.getTime(),to:n.getTime()};switch(t.unit){case"hours":case"days":case"weeks":r.from=r.to-e[t.unit]*t.num;break;case"months":n.setMonth(n.getMonth()-t.num);r.from=n.getTime();break;case"years":n.setFullYear(n.getFullYear()-t.num);r.from=n.getTime();break}return r}function gn(t,e,n,r){const i=dt(t);if(t.authentication){i.authentication=Tt.deserialize(t.authentication.serialize())}i.start=e>-1?e:n+1;return t=>{if(t){i.authentication=t}return r(i)}}function bn(t,e,n){let r=null;if(e.thumbnail){r=`${t}/community/groups/${e.id}/info/${e.thumbnail}`;if(n&&e.access!=="public"){r=`${r}?token=${n}`}}return r}function wn(t,e,n){let r=null;if(e.thumbnail){r=`${t}/community/users/${e.username}/info/${e.thumbnail}`;if(n&&e.access!=="public"){r=`${r}?token=${n}`}}return r}function yn(t){const e={};const n=["created","modified","lastlogin"];const r=["filterType","categoriesAsParam","categoryFilter","term","searchUserAccess","isopendata","searchUserName"];const i=[...n,...r];Object.entries(t).forEach((([s,o])=>{if(!i.includes(s)){gt(s,hn(o),e)}if(n.includes(s)){const n=dt(lt(t,s));if(lt(t,`${s}.type`)==="relative-date"){gt(s,mn(n),e)}else{gt(s,n,e)}}if(r.includes(s)&&t.hasOwnProperty(s)){gt(s,o,e)}}));return e}function vn(t){const e=t.filters.map(Sn);const n=e.filter(On);const r=kn(n,"AND");return r}function On(t){return!(typeof t==="undefined"||t===null||t==="")}function kn(t,e){const n=t.reduce(((t,n)=>{Object.entries(n).forEach((([n,r])=>{if(t[n]&&r!==""){t[n]=`${t[n]} ${e} ${r}`}else{if(r!==""){t[n]=r}}}));return t}),{q:""});return n}function Sn(t){const e=t.operation||"AND";const n=t.predicates.map(yn);const r=n.map($n).filter((t=>t!==undefined&&t!==null));const i=kn(r,e);if(n.length>1){i.q=`(${i.q})`}return i}function $n(t){const e=["created","modified"];const n=["isopendata"];const r=["searchUserAccess","searchUserName","categoriesAsParam","categoryFilter"];const i=["filterType","term",...e,...n,...r];const s=["access","capabilities","created","categories","categoriesAsParam","categoryFilter","description","disabled","email","emailstatus","firstname","fullname","group","id","isInvitationOnly","isopendata","joined","lastlogin","lastname","memberType","modified","name","orgid","orgIds","owner","provider","role","searchUserAccess","searchUserName","snippet","tags","term","title","type","typekeywords","userlicensetype","username"];const o=Object.entries(t).map((([t,o])=>{if(s.includes(t)){const s={q:""};if(!i.includes(t)&&t!=="term"){s.q=Dn(t,o)}if(e.includes(t)){s.q=jn(t,o)}if(n.includes(t)){s.q=`${t}:${o}`}if(r.includes(t)){s[t]=o}if(t==="term"){s.q=o}return s}})).filter(On);if(o.length){const t=kn(o,"AND");if(t.q){t.q=`(${t.q})`}return t}else{return null}}function Dn(t,e){let n="";if(e.any){n=`${En("OR",t,e.any)}`}if(e.all){n=(n?n+" AND ":"")+`${En("AND",t,e.all)}`}if(e.not){n=(n?n+" AND ":"")+`${En("OR",`-${t}`,e.not)}`}return n}function jn(t,e){return`${t}:[${e.from} TO ${e.to}]`}function En(t,e,n){let r="";if(Array.isArray(n)){r=`${e}:"${n.join(`" ${t} ${e}:"`)}"`;if(n.length>1){r=`(${r})`}}else{r=`${e}:"${n}"`}return r}async function An(t,e,n){const r={access:t.access,id:t.id,type:t.type,name:t.title,owner:t.owner,typeKeywords:t.typeKeywords,tags:t.tags,categories:t.categories,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"item.created",updatedDate:new Date(t.modified),updatedDateSource:"item.modified",family:ze(t.type),links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=[];e=[...i,...e].filter(ft);const s=e.map(Ne);const o=yt("enrichment",s).filter(ft);let a={};if(o.length){a=await Ve(t,o,n)}s.forEach((t=>{r[t.prop]=lt(a,t.path)}));r.links.thumbnail=Te(t,n);r.links.self=It(r.id,n);r.links.siteRelative=Xe(r.type,r.id,t.typeKeywords);return r}function xn(t){var e;if((e=t.aggregations)===null||e===void 0?void 0:e.counts){return t.aggregations.counts.map((t=>({mode:"terms",field:t.fieldName,values:t.fieldValues})))}else{return[]}}async function Tn(t,e){var n;if(!e.requestOptions){throw new xe("portalSearchItems","options.requestOptions is required.")}const r=Cn(t);r.filters=r.filters.map((t=>{t.predicates=t.predicates.map(yn);return t}));const i=vn(r);const s=["num","sortField","sortOrder","include","start","requestOptions"];s.forEach((t=>{if(e.hasOwnProperty(t)){i[t]=e[t]}}));if(e.requestOptions.authentication){i.authentication=e.requestOptions.authentication}else{i.portal=e.requestOptions.portal}if((n=e.aggFields)===null||n===void 0?void 0:n.length){i.countFields=e.aggFields.join(",");i.countSize=e.aggLimit||10}return Nn(i)}async function Nn(t){const e=await et(t);const n=e=>Rn(e,t.includes,t.requestOptions);const r=await Promise.all(e.results.map(n));const i=xn(e);return{total:e.total,results:r,aggregations:i,hasNext:e.nextStart>-1,next:gn(t,e.nextStart,e.total,Nn)}}async function Rn(t,e=[],n){let r=on;switch(t.type){case"Hub Site Application":case"Site Application":r=Ye;break;case"Hub Page":case"Site Page":r=An;break;case"Hub Project":r=Qe;break;case"Web Mapping Application":if(t.typeKeywords.includes("hubSite")){r=Ye}break}return r(t,e,n)}const Pn={$application:[{type:{any:["Web Mapping Application","Application","Insights","Web Experience"],not:["Insights Theme","Insights Model"]},typekeywords:{not:["hubSite","Story Map"]}},{type:"Web Mapping Experience",typekeywords:"EXB Experience"}],$dashboard:[{type:{any:["Dashboard"],not:["Operation View"]},typekeywords:{not:["Extension","ArcGIS Operation View"]}}],$dataset:[{type:{any:["Scene Service","Feature Collection","Route Layer","Layer","Explorer Layer","Tile Package","Vector Tile Package","Scene Package","Layer Package","Feature Service","Stream Service","Map Service","Vector Tile Service","Image Service","WMS","WFS","WMTS","KML","KML Collection","Globe Service","CSV","Shapefile","GeoJson","Service Definition","File Geodatabase","CAD Drawing","Relational Database Connection"],not:["Web Mapping Application","Geodata Service"]}},{typekeywords:["OGC","Geodata Service"]}],$document:[{type:["PDF","Microsoft Excel","Microsoft Word","Microsoft Powerpoint","iWork Keynote","iWork Pages","iWork Numbers","Visio Document","Document Link"]}],$initiative:[{type:"Hub Initiative"}],$experience:[{type:"Web Experience"}],$feedback:[{type:"Form"}],$page:[{typekeywords:"hubPage"}],$site:[{type:["Hub Site Application","Site Application"]}],$storymap:[{type:"Storymap"},{type:"Web Mapping Application",typekeywords:"Story Map"}],$template:[{type:["Web Mapping Application","Hub Initiative","Hub Initiative Template","Solution"],typekeywords:{any:["hubInitiativeTemplate","hubSolutionTemplate","Template"],not:"Deployed"}}],$webmap:[{type:{any:["Web Map","Web Scene"],not:"Web Mapping Application"}}]};function Cn(t){const e=dt(t);e.filters=e.filters.map((t=>{let e=false;t.predicates=t.predicates.reduce(((t,n)=>{if(In(n.type)){const r=_n(n.type);t=[...t,...r];e=true}else{t.push(n)}return t}),[]);if(e){t.operation="OR"}return t}));return e}function In(t){let e=false;if(typeof t==="string"){e=t in Pn}return e}function _n(t){return Pn[t]}function qn(t){const e=t.aggregations.aggregations.map((t=>({mode:"terms",field:t.field,values:t.aggregations.map((t=>({value:t.label,count:t.value})))})));return{total:0,results:[],hasNext:false,next:()=>null,aggregations:e}}function Mn(t,e){const n=`terms(fields=(${e.aggFields.join()}))`;const r=lt(e,"requestOptions.authentication.token");return{aggregations:n,token:r}}function Un(t){const e=Object.entries(t).filter((([t,e])=>!!e)).map((([t,e])=>`${t}=${e}`)).join("&");return e&&`?${e}`}async function Gn(t,e,n){var r;const i=((r=n.requestOptions)===null||r===void 0?void 0:r.fetch)||fetch;const s=t+Un(e);const o=await i(s,{method:"GET"});if(!o.ok){throw new sn(o.statusText,s,o.status)}return o.json()}async function Wn(t,e){const n=e.api;const r=`${n.url}/aggregations`;const i=Mn(t,e);const s=await Gn(r,i,e);return qn(s)}function Ln(t,e,n){const r=t.links.find((t=>t.rel==="next"));let i=()=>null;if(r){i=()=>{const t=new URL(r.href);const i=+t.searchParams.get("startindex");const s=Object.assign(Object.assign({},n),{start:i});return or(e,s)}}return i}function Fn(t,e,n){const r=t.properties;return Rn(r,e,n)}async function Hn(t,e,n){const r=await Promise.all(t.features.map((t=>Fn(t,n.include,n.requestOptions))));const i=Ln(t,e,n);const s=t.links.find((t=>t.rel==="next"));return{total:t.numberMatched,results:r,hasNext:!!s,next:i}}function Jn(t){return t.filters.map(Kn).filter((t=>t!=="()")).join(" AND ")}function Kn(t){const e=t.operation||"OR";const n=t.predicates.map(Vn).filter((t=>t!=="()")).join(` ${e} `);return`(${n})`}function Vn(t){const e=Object.entries(t).filter((([t,e])=>t!=="term"&&!!e)).reduce(((t,[e,n])=>{let r;if(typeof n==="string"){r=Qn(e,n)}else if(Array.isArray(n)){r=Yn(e,n)}else if(Bn(n)){r=zn(e,n)}else{r=Xn(e,n)}t.push(r);return t}),[]).join(" AND ");return`(${e})`}function Bn(t){return Number.isInteger(t.from)&&Number.isInteger(t.to)}function zn(t,e){return`${t} BETWEEN ${e.from} AND ${e.to}`}function Qn(t,e){return`${t}=${nr(e)}`}function Yn(t,e){const n=e.map(nr);return`${t} IN (${n.join(", ")})`}function Xn(t,e){const n=Zn(t,e.any);const r=tr(t,e.all);const i=er(t,e.not);return[n,r,i].filter((t=>!!t)).join(" AND ")}function Zn(t,e){let n;if(Array.isArray(e)){const r=e.map(nr);n=`${t} IN (${r.join(", ")})`}else if(e){n=Qn(t,e)}return n}function tr(t,e){let n;if(Array.isArray(e)){n=e.map((e=>Qn(t,e))).join(" AND ")}else if(e){n=Qn(t,e)}return n}function er(t,e){let n;if(e){const r=Array.isArray(e)?e:[e];const i=r.map(nr);n=`${t} NOT IN (${i.join(", ")})`}return n}function nr(t){const e=/\s/;return e.test(t)?`'${t}'`:t}function rr(t){const e=t.filters.filter((t=>t.predicates.find((t=>!!t.term))));const n=ir(e);return n===null||n===void 0?void 0:n.term}function ir(t){let e;if(t.length>1){throw new Error(`IQuery can only have 1 IFilter with a 'term' predicate but ${t.length} were detected`)}if(t.length){const n=t[0];const r=n.predicates.filter((t=>!!t.term));if(r.length>1){throw new Error(`IQuery can only have 1 'term' predicate but ${r.length} were detected`)}if(n.operation!=="AND"&&n.predicates.length>1){throw new Error(`'term' predicates cannot be OR'd to other predicates`)}const i=r[0];if(typeof i.term!=="string"){throw new Error(`'term' predicate must have a string value, string[] and IMatchOptions are not allowed.`)}e=i}return e}function sr(t,e){const n=Jn(t);const r=lt(e,"requestOptions.authentication.token");const i=e.num;const s=e.start;const o=rr(t);return{filter:n,token:r,limit:i,startindex:s,q:o}}async function or(t,e){const n=e.api;const r=`${n.url}/items`;const i=sr(t,e);const s=await Gn(r,i,e);return Hn(s,t,e)}async function ar(t,e){var n;if(!e.useBeta){throw new Error("Not implemented")}return((n=e.aggFields)===null||n===void 0?void 0:n.length)?Wn(t,e):or(t,e)}async function cr(t,e){if(!e.requestOptions){throw new xe("portalSearchGroups","options.requestOptions is required.")}t.filters=t.filters.map((t=>{t.predicates=t.predicates.map(yn);return t}));const n=vn(t);const r=["num","sortField","sortOrder","include","start","requestOptions"];r.forEach((t=>{if(e.hasOwnProperty(t)){n[t]=e[t]}}));if(e.requestOptions.authentication){n.authentication=e.requestOptions.authentication}else{n.portal=e.requestOptions.portal}return ur(n)}async function ur(t){const e=await nt(t);const n=e=>lr(e,t.include,t.requestOptions);const r=await Promise.all(e.results.map(n));return{total:e.total,results:r,hasNext:e.nextStart>-1,next:gn(t,e.nextStart,e.total,ur)}}async function lr(t,e=[],n){return vr(t,e,n)}const dr=t=>{const{data:e,stack:n,requestOptions:r}=t;const i=n.start("enrichUserOrg");const s=Object.assign(Object.assign({},r),{portal:`${qt(r.portal)}/sharing/rest`});return Ce(e.user.orgId,s).then((t=>{n.finish(i);return{data:Object.assign(Object.assign({},e),{org:t}),stack:n,requestOptions:r}})).catch((e=>pr(e,t,i)))};const pr=(t,e,n)=>{const{data:r,stack:i,requestOptions:s}=e;i.finish(n,{error:t});return{data:Object.assign(Object.assign({},r),{errors:Ke(t,r.errors)}),stack:i,requestOptions:s}};const fr={org:dr};function hr(t,e,n){const r=e.reduce(((t,e)=>{const n=fr[e];n&&t.push(n);return t}),[]);const i=wt(r);return i({data:{user:t},stack:new Re,requestOptions:n}).then((t=>t.data))}async function mr(t,e,n){const r={access:t.access,id:t.username,type:"User",name:t.fullName,owner:t.username,summary:t.description,createdDate:new Date(t.created),createdDateSource:"user.created",updatedDate:new Date(t.modified),updatedDateSource:"user.modified",family:"people",links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};const i=["org.name AS orgName"];e=[...i,...e].filter(ft);const s=e.map(Ne);const o=yt("enrichment",s).filter(ft);let a={};if(o.length){a=await hr(t,o,n)}s.forEach((t=>{r[t.prop]=lt(a,t.path)}));const c=n.authentication.token;r.links.thumbnail=wn(n.portal,t,c);r.links.self=Ut(r.id,n);r.links.siteRelative=`/people/${r.id}`;return r}async function gr(t,e){if(!e.requestOptions){throw new xe("portalSearchUsers","requestOptions: IHubRequestOptions is required.")}if(!e.requestOptions.authentication){throw new xe("portalSearchUsers","requestOptions must pass authentication.")}t.filters=t.filters.map((t=>{t.predicates=t.predicates.map(yn);return t}));const n=vn(t);const r=["num","sortField","sortOrder","include","start","requestOptions"];r.forEach((t=>{if(e.hasOwnProperty(t)){n[t]=e[t]}}));n.authentication=e.requestOptions.authentication;return br(n)}async function br(t){const e=await ot(t);const n=e=>wr(e,t.include,t.requestOptions);const r=await Promise.all(e.results.map(n));return{total:e.total,results:r,hasNext:e.nextStart>-1,next:gn(t,e.nextStart,e.total,br)}}async function wr(t,e=[],n){return mr(t,e,n)}async function yr(t,e){if(!t){throw new xe("hubSearch","Query is required.")}if(!t.filters||!t.filters.length){throw new xe("hubSearch","Query must contain at least one Filter.")}if(!e.requestOptions){throw new xe("hubSearch","requestOptions: IHubRequestOptions is required.")}if(!e.include){e.include=[]}const n=t.targetEntity;const r=fn(e.api||"arcgis").type;const i={arcgis:{item:Tn,group:cr,user:gr},"arcgis-hub":{item:ar}};const s=lt(i,`${r}.${n}`);if(!s){throw new xe(`hubSearch`,`Search via "${n}" filter against "${r}" api is not implemented. Please ensure "targetEntity" is defined on the query.`)}return s(dt(t),e)}async function vr(t,e,n){const r={access:t.access,id:t.id,type:"Group",name:t.title,owner:t.owner,summary:t.snippet||t.description,createdDate:new Date(t.created),createdDateSource:"group.created",updatedDate:new Date(t.modified),updatedDateSource:"group.modified",family:"team",links:{self:"not-implemented",siteRelative:"not-implemented",thumbnail:"not-implemented"}};r.isSharedUpdate=(t.capabilities||[]).includes("updateitemcontrol");r.membershipAccess=t.membershipAccess;r.isOpenData=!!t.isOpenData;const i=[];e=[...i,...e].filter(ft);const s=e.map(Ne);const o=yt("enrichment",s).filter(ft);let a={};if(o.length){a=await dn(t,o,n)}s.forEach((t=>{r[t.prop]=lt(a,t.path)}));r.links.thumbnail=bn(n.portal,t);r.links.self=Mt(r.id,n);r.links.siteRelative=`/teams/${r.id}`;return r}class Or extends sn{constructor(t,e,n,r){super(t,e,n);this.error=r}}function kr(t){const{token:e,authentication:n}=t;let r=()=>Promise.resolve(e);if(n){r=n.getToken.bind(n,n.portal)}return r()}function Sr(t,e,n){const r=new Headers(e.headers);r.append("Content-Type","application/json");if(n){r.append("Authorization",`Bearer ${n}`)}const i={headers:r,method:e.httpMethod||"GET",mode:e.mode,cache:e.cache,credentials:e.credentials};const s=Nt({host:e.hubApiUrl||"https://hub.arcgis.com",path:"/api/discussions/v1"});if(e.data){if(e.httpMethod==="GET"){const n=new URLSearchParams(e.data).toString();t+=`?${n}`}else{i.body=JSON.stringify(e.data)}}const o=[s.replace(/\/$/,""),t.replace(/^\//,"")].join("/");return fetch(o,i).then((t=>{if(t.ok){return t.json()}else{const{statusText:e,status:n}=t;return t.json().then((t=>{throw new Or(e,o,n,JSON.stringify(t.message))}))}}))}function $r(t,e){return kr(e).then((n=>Sr(t,e,n)))}function Dr(t){const e=`/posts`;t.httpMethod="GET";return $r(e,t)}function jr(t){const e=`/posts`;return $r(e,Object.assign({httpMethod:"POST"},Er(t)))}function Er(t){const{mentionUrl:e}=t,n=ut(t,["mentionUrl"]);if(e){n.headers=Object.assign(Object.assign({},n.headers),{"mention-url":e})}return n}function Ar(t){t.httpMethod="GET";return $r(`/channels`,t)}function xr(t){t.httpMethod="POST";return $r(`/channels`,t)}var Tr;(function(t){t["ASC"]="ASC";t["DESC"]="DESC"})(Tr||(Tr={}));var Nr;(function(t){t["THUMBS_UP"]="thumbs_up";t["THUMBS_DOWN"]="thumbs_down";t["THINKING"]="thinking";t["HEART"]="heart";t["ONE_HUNDRED"]="one_hundred";t["SAD"]="sad";t["LAUGH"]="laugh";t["SURPRISED"]="surprised"})(Nr||(Nr={}));var Rr;(function(t){t["PUBLIC"]="public";t["ORG"]="org";t["PRIVATE"]="private"})(Rr||(Rr={}));var Pr;(function(t){t["PENDING"]="pending";t["APPROVED"]="approved";t["REJECTED"]="rejected";t["DELETED"]="deleted";t["HIDDEN"]="hidden"})(Pr||(Pr={}));var Cr;(function(t){t["GROUP"]="group";t["CONTENT"]="content"})(Cr||(Cr={}));var Ir;(function(t){t["HUB"]="hub";t["AGO"]="ago";t["URBAN"]="urban"})(Ir||(Ir={}));var _r;(function(t){t["REPLIES"]="replies";t["REACTIONS"]="reactions";t["PARENT"]="parent";t["CHANNEL"]="channel"})(_r||(_r={}));var qr;(function(t){t["POST"]="post"})(qr||(qr={}));var Mr;(function(t){t["HAS_USER_POSTS"]="has_user_posts"})(Mr||(Mr={}));var Ur;(function(t){t["CREATED_AT"]="createdAt";t["CREATOR"]="creator";t["EDITOR"]="editor";t["ID"]="id";t["UPDATED_AT"]="updatedAt"})(Ur||(Ur={}));var Gr;(function(t){t["READ"]="read";t["WRITE"]="write";t["READWRITE"]="readWrite";t["MODERATE"]="moderate";t["MANAGE"]="manage";t["OWNER"]="owner"})(Gr||(Gr={}));var Wr;(function(t){t["BODY"]="body";t["CHANNEL_ID"]="channelId";t["CREATED_AT"]="createdAt";t["CREATOR"]="creator";t["DISCUSSION"]="discussion";t["EDITOR"]="editor";t["ID"]="id";t["PARENT_ID"]="parentId";t["STATUS"]="status";t["TITLE"]="title";t["UPDATED_AT"]="updatedAt"})(Wr||(Wr={}));var Lr;(function(t){t["Text"]="text";t["Announcement"]="announcement";t["Poll"]="poll";t["Question"]="question"})(Lr||(Lr={}));var Fr;(function(t){t["ACCESS"]="access";t["CREATED_AT"]="createdAt";t["CREATOR"]="creator";t["EDITOR"]="editor";t["ID"]="id";t["LAST_ACTIVITY"]="last_activity";t["UPDATED_AT"]="updatedAt"})(Fr||(Fr={}));var Hr;(function(t){t["SETTINGS"]="settings";t["CHANNEL_ACL"]="channelAcl"})(Hr||(Hr={}));var Jr;(function(t){t["GROUP"]="group";t["ORG"]="org";t["USER"]="user";t["ANONYMOUS_USER"]="anonymousUser";t["AUTHENTICATED_USER"]="authenticatedUser"})(Jr||(Jr={}));var Kr;(function(t){t["ADMIN"]="admin";t["MEMBER"]="member"})(Kr||(Kr={}));const Vr=":host{display:block}";const Br=class{constructor(e){t(this,e);this.groups=[]}async componentWillRender(){this.groups=await this.getGroups(O.user)}async getGroups(t){if(!t){return[]}const e=(new Z).match(t.username).in("owner");const n=await nt({q:e,portal:`${O.app.portal}/sharing`});console.log({groups:n});return n.results}async requestChannel(t){const e={access:Rr.PRIVATE,groups:[t],defaultPostStatus:Pr.APPROVED};console.debug("createChannel",{createOptions:e});const n=xr(Object.assign({data:e},O.context.hubRequestOptions));console.debug("createChannel",{response:n})}render(){return e(n,null,e("slot",null),e("calcite-list",null,this.groups.map((t=>e("calcite-list-item",{label:t.title,description:t.snippet},e("calcite-avatar",{scale:"m",slot:"content-start",thumbnail:"https://www.seekpng.com/png/detail/90-906849_89kib-1024x631-finn-finn-adventure-time-face.png"}),e("calcite-dropdown",{scale:"m",slot:"actions-end"},e("calcite-action",{icon:"ellipsis",label:"menu",slot:"dropdown-trigger"}),e("calcite-dropdown-group",null,e("calcite-dropdown-item",{id:`group-${t.id}`,onclick:()=>{this.requestChannel(t.id)}},"Create Channel"))))))))}};Br.style=Vr;const zr=":host{display:block}";const Qr=class{constructor(e){t(this,e);this.channels=[]}async componentWillLoad(){this.channels=await this.getChannels()}async getChannels(){const t={};const e=await Ar(Object.assign({data:t},O.context.hubRequestOptions));return e.items}render(){console.log("Render channels",this.channels);return e(n,null,e("slot",null),e("calcite-list",null,this.channels.map((t=>e("calcite-list-item",{label:t.id,description:`Channel creator: ${t.creator}`},e("calcite-icon",{scale:"s",icon:"speech-bubble",slot:"content-start"}))))))}};Qr.style=zr;const Yr=":host{display:block}#posts{min-height:calc(100vh-70px);overflow-y:scroll}#editor{height:70px;bottom:0px;position:sticky;background-color:white}";const Xr=class{constructor(e){t(this,e);this.channelId=null;this.posts=[]}async componentWillLoad(){this.posts=await this.getChannelPosts(this.channelId)}async getChannelPosts(t){console.debug("getChannelPosts",{channel:t});const e={channels:[this.channelId]};const n=await Dr(Object.assign({data:e},O.context.hubRequestOptions));return n.items}render(){console.log("Render posts",this.posts);return e(n,null,e("slot",null),e("calcite-list",{id:"posts"},this.posts.map((t=>e("calcite-list-item",{description:t.creator,label:t.body},e("calcite-icon",{scale:"s",icon:"speech-bubble",slot:"content-start"}),e("div",{slot:"content-end"},c(t.createdAt),e("calcite-chip",{class:"list-chip",icon:"organization",scale:"s"},"Staff")))))),e("hub-discussions-post-editor",{id:"editor","channel-id":this.channelId}))}};Xr.style=Yr;const Zr=":host{display:block;padding:0.2rem}#prompt{font-weight:400;font-style:italic}";const ti=class{constructor(e){t(this,e);this.channelId=null}componentDidRender(){console.log("postEditor did render",this.postBodyInput)}postSubmitted(t){console.log("postSubmitted",{value:this.postBodyInput.value,_evt:t});this.createPost(this.postBodyInput.value)}async createPost(t){const e={channelId:this.channelId,body:t};const n=jr(Object.assign({data:e},O.context.hubRequestOptions));return n}render(){return e(n,null,e("slot",null),e("calcite-label",null,e("span",{id:"prompt"},"What's on your mind?"),e("calcite-input",{id:"input-with-text-area",type:"input",value:"",placeholder:"Write your discussion post.",alignment:"start","number-button-type":"vertical",scale:"m",status:"idle",ref:t=>this.postBodyInput=t},e("calcite-button",{slot:"action",onclick:this.postSubmitted.bind(this)},"post")),e("calcite-input-message",{status:"idle",scale:"m"},"help")))}};ti.style=Zr;function ei(t,e){let n;const r=Object.assign({},e);if(t==="cancelled"){if(!e.orderByFields){r.orderByFields="EditDate DESC"}n=`isCancelled=1 AND status<>'draft'`}else if(t==="draft"){if(!e.orderByFields){r.orderByFields="EditDate DESC"}const t=e.authentication;const i=t?t.username:null;n=`Creator = '${i}' AND status = 'draft'`}else{if(!e.orderByFields){r.orderByFields=t==="upcoming"?"startDate ASC":"startDate DESC"}const i=t==="upcoming"?">":"<=";n=`endDate${i}CURRENT_TIMESTAMP AND (isCancelled<>1 OR isCancelled IS NULL) AND status<>'draft'`}if(e.where){r.where=`${e.where} AND ${n}`}else{r.where=n}return r}function ni(t){const e=Object.assign({returnGeometry:true},t);return Zt(e).then((n=>{if(n.features.length<=0){return{data:[],included:[]}}if(e.authentication){return e.authentication.getToken(e.url).then((r=>ri(n.features,e.url,t,r)))}else{return ri(n.features,e.url,t)}}))}function ri(t,e,n,r){const i=[];const s=[];const o=[];const a=(new Date).getTime();let c="";t.forEach((function(t){const n=t.attributes;const o=t.geometry;let u=null;if(n.imageAttributes){const t=JSON.parse(n.imageAttributes);if(t.crop){u=`${e}/${n.OBJECTID}/attachments/${t.crop}?v=${a}`;if(r){u+=`&token=${r}`}}}s.push({id:n.OBJECTID,type:"events",imageUrl:u,attributes:n,geometry:o});const l=n.siteId;if(l!=null&&i.indexOf(l)===-1){i.push(l);c+=c.length>0?" OR id:":"id:";c+=l}}));if(i.length===0){return{included:o,data:s}}const u=n;u.q=c;return et(u).then((function(t){t.results.forEach((t=>{o.push({id:t.id,type:`sites`,attributes:{id:t.id,url:t.url}})}));return{included:o,data:s}}))}async function ii(t){let e=[];let n=await nt(Object.assign({q:"tags:Hub Event Group",params:{searchUserAccess:"groupMember",num:100}},t.requestOptions));let r=n.results.reduce(((t,e)=>{t.push(`groupId = '${e.id}'`);return t}),[]);try{const n=await J(t.eventsConfig.publicViewId,Object.assign({},t.requestOptions));const i=`${n.url}/0`;const s=ei("upcoming",{url:i,authentication:t.session});if(!!r){s.where+=` AND (${r.join(" OR ")})`}console.debug("getMemberEvents: getEventQueryFromType",{searchOptions:s});let o=await ni(s);console.debug("getMemberEvents: searchEvents",[s,o]);e=o.data.reduce(((t,e)=>{t.push(e.attributes);return t}),[])}catch(e){console.error("Error in getMemberEvents",{error:e,context:t,portalUrl:t.portalUrl})}console.debug("getEvents 1",{events:e,groups:n,eventGroups:r});return{results:e,meta:{total:r.length,count:e.length,start:1}}}const si=":host{display:block}";const oi=class{constructor(e){t(this,e);this.events=[]}componentWillLoad(){this.getEvents()}async getEvents(){const t=await ii(O.context);console.debug("getEvents",{results:t});this.events=t.results}render(){return e(n,null,e("slot",null),e("calcite-list",{id:"posts"},this.events.map((t=>e("calcite-list-item",{label:t["title"],description:t["description"]},e("calcite-icon",{scale:"s",icon:"event",slot:"content-start"}),e("div",{slot:"content-end"}))))))}};oi.style=si;const ai=":host{display:block}.entry{display:block;border-bottom:1px solid gray;padding:0.5rem 0.2rem}.title{font-weight:500}.timestamp{font-size:0.6rem;font-weight:300;margin-left:0.2rem}";const ci=class{constructor(e){t(this,e);this.collection=null;this.entries=[]}async componentWillRender(){await this.fetchResults()}async fetchResults(){var t,e;if(!!((t=this.collection)===null||t===void 0?void 0:t.scope)){const t=(e=this.collection)===null||e===void 0?void 0:e.scope;const n={sortOrder:"desc",sortField:"modified",requestOptions:O.context.hubRequestOptions};const r=await yr(t,n);this.entries=r.results}}render(){var t;return e(n,null,e("slot",null),e("calcite-list",null,(t=this.entries)===null||t===void 0?void 0:t.map((t=>e("calcite-list-item",{label:t.name,description:c(t.updatedDate)},e("calcite-icon",{scale:"s",icon:"files",slot:"content-start"}),e("calcite-dropdown",{scale:"m",slot:"actions-end"},e("calcite-action",{icon:"ellipsis",label:"menu",slot:"dropdown-trigger"}),e("calcite-dropdown-group",null,e("calcite-dropdown-item",{onclick:()=>{window.open(`${O.context.hubUrl}/content/${t.id}`,"_blank")}},"View Item"))))))))}};ci.style=ai;const ui=":host{display:block}";const li=class{constructor(e){t(this,e);this.statusTypes={normal:{icon:"thumbs-up",color:"green"},degraded:{icon:"exclamation-mark-circle",color:"yellow"},down:{icon:"x-octagon-f",color:"red"}};this.statusUrl="https://arcgis.github.io/hub-status/status.json";this.status={}}componentDidLoad(){this.fetchStatus()}async fetchStatus(){let t=await fetch(this.statusUrl);let e=await t.json();this.status=e}render(){var t,r,i,s;return e(n,null,e("calcite-list",{id:"status"},e("calcite-list-item",{label:"Overall",description:(r=(t=this.status)===null||t===void 0?void 0:t.overview)===null||r===void 0?void 0:r.status}),(s=(i=this.status)===null||i===void 0?void 0:i.services)===null||s===void 0?void 0:s.map((t=>{var n,r;return e("calcite-list-item",{label:t["Service Name"],description:(r=(n=this.status)===null||n===void 0?void 0:n.overview)===null||r===void 0?void 0:r.status},e("calcite-chip",{icon:this.statusTypes[t["Status"]].icon,slot:"content-end"},t["Status"]))}))))}};li.style=ui;const di=":host{display:block;padding:0.5rem}";const pi=class{constructor(e){t(this,e)}render(){return e(n,null,e("slot",null))}};pi.style=di;const fi=":host{display:block}";const hi=class{constructor(e){t(this,e);this.notifications=[]}componentWillLoad(){this.getNotifications()}async getNotifications(){const t=await st(Object.assign({},O.context.requestOptions));this.notifications=t.notifications}render(){return e(n,null,e("slot",null),e("calcite-list",{id:"posts"},this.notifications.map((t=>e("calcite-list-item",{label:t.type,description:t.data.groupTitle},e("calcite-icon",{scale:"s",icon:"envelope",slot:"content-start"}),e("div",{slot:"content-end"},c(t.received)))))))}};hi.style=fi;function mi(t){var e,n;const r={key:"collection",label:"collection",targetEntity:(e=t.type)!==null&&e!==void 0?e:"item",scope:{targetEntity:(n=t.type)!==null&&n!==void 0?n:"item",filters:[{predicates:[]}]}};if(!!t.query){r.scope.filters[0].predicates.push({term:t.query})}if(!!t.groups){r.scope.filters[0].predicates.push({group:t.groups})}return r}const gi=':host{display:block;overflow:scroll;width:100vw;height:100vh}.workspace{display:grid;grid-template-columns:10rem auto;grid-template-rows:auto;grid-template-areas:"global global"\n    "header header"\n    "navigation panel"\n    "footer footer"}#global{grid-area:global;background-color:#4e4e4e}#header{grid-area:header;border-bottom:1px solid gray;display:none}#navigation{grid-area:navigation;border-right:1px solid gray}#footer{grid-area:footer;border-top:1px solid gray;background-color:#fefefe;padding:2rem;margin-top:1rem}#panel{grid-area:panel}.space{display:grid;grid-template-columns:repeat( auto-fit, minmax(300px, 1fr) );gap:10px;grid-auto-rows:minmax(100px, auto);padding:1rem}';const bi=class{constructor(e){t(this,e);this.client=null;this.redirect=null;this.portal="https://www.arcgis.com";this.defaultConfig="./data/default.json";this.config=null}componentWillLoad(){O.app={client:this.client,redirect:this.redirect,portal:this.portal}}async loadConfiguration(){let t=await fetch(`./data/${O.user.username}.json`);console.debug("loadConfiguration: result",{result:t});if(t.status===404){t=await fetch(`./${this.defaultConfig}`)}const e=await t.json();this.config=e}updateAppState(t){O.app.redirect=t}componentDidLoad(){if(!!O.user){this.loadConfiguration()}}render(){return e(n,null,e("div",{class:"workspace"},e("div",{id:"global"},e("workspace-navigation",null)),e("div",{id:"header"},e("slot",{name:"header"})),e("div",{id:"navigation"},"navigation"),e("div",{id:"panel"},!!O.user?this.renderWorkspace(this.config):e("span",null,"Sign in with AGO QA account.")),e("div",{id:"footer"},e("em",null,"footer..."))))}renderWorkspace(t){let n=[];let r=[];console.debug("Rendering workspaces");if(!!t){t.spaces.map(((i,s)=>{n.push(e("calcite-tab-title",{selected:i.title===t.default},i.title));let o=[];i.layout.cards.map((t=>{const n=`${t.type}`;const r={user:O.user};const i=Ae(t.values,r);const s=Ae(t.text,r);Object.keys(i).map((t=>{if(t==="collection"){i[t]=mi(i[t])}}));o.push(e("workspace-card",null,e("span",{slot:"title"},t.title),e(n,Object.assign({},i),s)))}));r.push(e("calcite-tab",{selected:i.title===t.default},e("div",{class:"space"},o)))}))}const i=e("calcite-tabs",null,e("calcite-tab-nav",{slot:"tab-nav"},n,e("calcite-button",{appearance:"transparent","icon-start":"plus",onclick:t=>{alert("This will create a new space")}},"Create Space")),r);return i}renderDefaultWorkspace(){return e("div",null,e("workspace-card",null,e("span",{slot:"title"},"About this Workspace"),e("hub-text",null,"Personalized workspace for ",e("a",{href:`${O.context.hubUrl}/people/${O.user.username}`},O.user.fullName),".",e("br",null),e("br",null),"There is quick access to my favorites, specific project discussions, and recent content.")),e("workspace-card",null,e("span",{slot:"title"},"Project Discussion"),e("hub-discussions-moderation",{"channel-id":"0311a680ff1b44389ad0392f94d5bbbb"})),e("workspace-card",null,e("span",{slot:"title"},"Recent Updates"),e("hub-feed",{collection:mi({query:["Initiative"],type:"item"})})),e("workspace-card",null,e("span",{slot:"title"},"Notifications"),e("hub-user-notifications",null)),e("workspace-card",null,e("span",{slot:"title"},"Favorites"),e("hub-feed",{collection:mi({groups:[O.user.favGroupId],type:"item"})})),e("workspace-card",null,e("span",{slot:"title"},"Upcoming Events"),e("hub-events",null)),e("workspace-card",null,e("span",{slot:"title"},"Collaborations"),e("hub-collaborations",null)),e("workspace-card",null,e("span",{slot:"title"},"Channels"),e("hub-discussions-channels",null)),e("workspace-card",null,e("span",{slot:"title"},"Hub Changelog"),e("hub-changelog",null)),e("workspace-card",null,e("span",{slot:"title"},"Hub Status"),e("hub-status",null)),e("workspace-card",null,e("span",{slot:"title"},"Work in Progress"),e("hub-text",null,"Todo:",e("ol",null,e("li",null,"Make Engagement Stats dynamic"),e("li",null,"Add Nearby based on User places of interest")))),e("workspace-card",null,e("span",{slot:"title"},"Engagement Stats"),e("hub-activity-stats",null)),e("workspace-card",null,e("span",{slot:"title"},"Nearby"),e("em",null,"map coming...")))}static get watchers(){return{redirect:["updateAppState"]}}};bi.style=gi;const wi=":host{display:block;width:auto;height:300px;border:1px solid rgb(161, 161, 161);position:relative;overflow:auto}.title{font-weight:600;width:100%;display:block;border-bottom:1px solid #888;background-color:#f0f0f0;padding:0.5rem;height:20px;position:sticky;top:0px;z-index:100}.tab{line-height:3em;display:none;cursor:pointer}:host(:hover) .tab{display:block;position:absolute;cursor:pointer;top:-10px;border:1px solid #AAA;background-color:#DDD}";const yi=class{constructor(e){t(this,e)}render(){return e(n,null,e("div",{class:"tab"},this.renderTab()),e("div",{class:"tab-content"},e("span",{class:"title"},e("slot",{name:"title"})),e("span",{class:"body"},e("slot",null))))}renderTab(){return e("calcite-list",null,e("calcite-list-item",{label:"Card",description:""},e("calcite-action",{icon:"drag",label:"drag",scale:"s",slot:"actions-start"}),e("calcite-action",{icon:"pencil",label:"edit",slot:"actions-end"}),e("calcite-action",{icon:"x",label:"delete",slot:"actions-end"}),e("calcite-action",{icon:"ellipsis",label:"menu",slot:"actions-end"})))}};yi.style=wi;const vi=":host{display:block}#title{color:white;font-size:500;padding:auto 0}#profile{float:right}";const Oi=class{constructor(e){t(this,e)}signinClick(){const t=new CustomEvent("arcgisAppIdentityStartSignIn");document.dispatchEvent(t)}signoutClick(){const t=new CustomEvent("arcgisAppIdentityStartSignOut");document.dispatchEvent(t)}signedinEvent(t){O.context=t.detail}signedoutEvent(t){O.context=null}render(){return e(n,null,e("slot",null),e("span",{id:"title"},"ArcGIS Hub"),e("span",{id:"profile"},e("arcgis-app-identity",{"client-id":O.app.client,"redirect-uri":O.app.redirect,portal:O.app.portal}),this.renderIdentity()))}renderIdentity(){var t;if(!!O.user){return e("calcite-dropdown",null,e("calcite-button",{slot:"dropdown-trigger"},(t=O.user)===null||t===void 0?void 0:t.fullName),e("calcite-dropdown-group",null,e("calcite-dropdown-item",{onclick:this.signoutClick},"Sign Out")))}else{return e("calcite-button",{ref:t=>this.signinButton=t,onclick:this.signinClick},"Sign In")}}};Oi.style=vi;export{o as hub_activity_stats,d as hub_changelog,Br as hub_collaborations,Qr as hub_discussions_channels,Xr as hub_discussions_moderation,ti as hub_discussions_post_editor,oi as hub_events,ci as hub_feed,li as hub_status,pi as hub_text,hi as hub_user_notifications,bi as hub_user_workspace,yi as workspace_card,Oi as workspace_navigation};
//# sourceMappingURL=p-fec3837a.entry.js.map